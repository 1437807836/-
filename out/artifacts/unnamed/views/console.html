<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="../assets/css/layui.css">
    <link rel="stylesheet" href="../assets/css/view.css" />
    <title>保险清单</title>
    <!--额外的样式-->
    <style>
        .layui-form-mid-width {
            width: 100px;
        }

        .layui-input-inline-width {
            width: 200px;
        }

        .layui-select-s {
            width: 200px;
            height: 38px;
            padding-left: 10px;
            border-color: #e6e6e6;
        }

        .btn-arr {
            margin-top: 30px;
        }

        .layui-form-mid {
            font-size: 12px;
            color: #666;
        }
    </style>
    <style type="text/css">
        .uploader-list {
            margin-left: -15px;
        }

        .uploader-list .info {
            position: relative;
            margin-top: -25px;
            background-color: black;
            color: white;
            filter: alpha(Opacity=80);
            -moz-opacity: 0.5;
            opacity: 0.5;
            width: 100px;
            height: 25px;
            text-align: center;
            display: none;
        }

        .uploader-list .handle {
            position: relative;
            background-color: black;
            color: white;
            filter: alpha(Opacity=80);
            -moz-opacity: 0.5;
            opacity: 0.5;
            width: 100px;
            text-align: right;
            height: 18px;
            margin-bottom: -18px;
            display: none;
        }

        .layui-table tbody tr:hover,
        .layui-table-click {
            background-color: #1c89e5;
            color: #fff;
        }

        .uploader-list .handle span:hover {
            cursor: pointer;
        }

        .uploader-list .file-iteme {
            margin: 12px 0 0 15px;
            padding: 1px;
            float: left;
        }

        .white_content {
            display: none;
            position: absolute;
            top: 25%;
            left: 25%;
            width: 50%;
            height: 25%;
            padding: 20px;
            background-color: #F7F7F7;
            /* background-color: #F8F8F8!important; */
            z-index: 1002;
            overflow: auto;
        }

        /*    margin-top:5px*/
        .marginTop {
            margin-top: 5px !important;
        }

        /*    批量导入的标题样式*/
        .importStyle {
            text-align: center;
            display: block;
            font-size: 25px;
            margin-bottom: 8px;
        }

        /*    选择文件*/
        .chooseFile {
            text-align: center;
            display: block;
            font-size: 12px;
        }

        /*    设置短的select*/
        .shortSelect {
            display: inline !important;

        }

        /* 修改新增select边框 */
        .newSelect .layui-input,
        .layui-select,
        .layui-textarea {
            border: none;
            position: relative;
            left: -10px;

        }

        .newSelect .layui-input,
        .layui-textarea {
            padding-left: 10px;
        }

        .newSelect .layui-edge {
            left: -1px;
        }

        .newSubmit .layui-edge {
            top: 21px;
        }

        .newSelect .layui-form-selected dl {
            font-size: 12px !important;
        }

        /* select左移 */
        .selectLeft .layui-form-select dl {
            left: -17px !important;
            top: 30px !important;
        }

        .newSubmit .layui-form-select dl {
            left: -30px !important;
            top: 32px !important;
        }

        /*  */
        #showDetail {
            font-size: 10px !important;
        }

        #showDetail .layui-row {
            margin: 12px !important;
            margin-bottom: 0;
        }

        #demo121 .uploader-list .file-iteme {
            margin: 0 12px !important;
        }

        /* icon样式 */
        .iconStyle {
            position: absolute;
            top: 4px;
            right: 14px
        }

        .only .layui-input,
        .layui-select,
        .layui-textarea {
            border-color: #ccc;
        }

        /* 输入框样式 */
        .common {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }

        .only .layui-form-mid {
            margin-right: 5px;
        }

        .layui-col-md-offset6 {
            margin-right: 0 !important;
        }

        .table-checked-bg {
            background-color: #1c89e5;
            color: #fff;
        }
    </style>

</head>

<body class="layui-view-body">
    <div class="layui-content">

        <div class="layui-row layui-col-space20">
            <div class="layui-row">
                <div class="layui-card">
                    <div class="layui-card-body">
                        <div class="form-box only">
                            <div class="layui-form layui-form-item">
                                <div class="layui-inline">
                                    <div class="layui-row common">
                                        <div class="layui-form-mid">业务编号:</div>
                                        <div class="layui-input-inline" style="width: 50px;">
                                            <input type="text" autocomplete="off" class="layui-input" id="businessID">
                                            <input type="text" autocomplete="off" class="layui-input"
                                                style="display: none;" id="yId">
                                        </div>
                                        <div class="layui-form-mid">代理人:</div>
                                        <div class="layui-input-inline" style="width: 50px;">
                                            <!-- <select name="sex" id="AgentSelect">
                                                <option value=""></option>

                                            </select> -->
                                            <input type="text" id="Agentpo" autocomplete="off" class="layui-input">
                                        </div>
                                        <div class="layui-form-mid">客户:</div>
                                        <div class="layui-input-inline" style="width: 50px;">
                                            <input type="text" id="tabSafePerson" autocomplete="off"
                                                class="layui-input">
                                        </div>
                                        <div class="layui-form-mid">车牌:</div>
                                        <div class="layui-input-inline" style="width: 50px;">
                                            <input type="text" id="tabCarNum" autocomplete="off" class="layui-input">
                                        </div>
                                        <div class="layui-form-mid">使用性质:</div>
                                        <div class="layui-input-inline" style="width: 80px;">
                                            <!-- <input type="text" id="natureSelect" autocomplete="off"
                                            class="layui-input"> -->
                                            <select name="sex" id="natureSelect">
                                                <option value=""></option>
                                                <option value="1">非运营</option>
                                                <option value="2">运营</option>
                                                <option value="3">出租车</option>
                                                <option value="4">特种车</option>
                                                <option value="5">运营大巴</option>
                                                <option value="6">非运营客车</option>
                                                <option value="7">非运营货车</option>
                                                <option value="8">运营客车</option>
                                                <option value="9">运营货车</option>
                                            </select>
                                        </div>

                                        <div class="layui-form-mid" style="display: none;">险种:</div>
                                        <div class="layui-input-inline" style="width: 80px;display: none;">
                                            <!-- <input type="text" id="tabYxState" autocomplete="off"
                                            class="layui-input"> -->
                                            <select name="sex" id="tabYxState">
                                                <option value=""></option>
                                                <option value="1">车险</option>
                                                <option value="2">车险批单</option>
                                                <option value="3">非车险批单</option>
                                                <option value="4">企财基本险</option>
                                                <option value="5">企财综合险</option>
                                            </select>
                                        </div>

                                        <div class="layui-form-mid">保险公司:</div>
                                        <div class="layui-input-inline" style="width: 100px;">
                                            <!-- <select name="sex" id="insuranceSelect">
                                            <option value=""></option> -->
                                            <select name="sex" id="insuranceSelect">
                                                <option value=""></option>
                                                <option value="1">xxx保险公司</option>
                                                <option value="2">保险公司</option>
                                            </select>
                                            </select>
                                        </div>
                                        <div class="layui-form-mid">渠道:</div>
                                        <div class="layui-input-inline" style="width: 80px;">
                                            <!-- <input type="text" id="channelNameSelect" autocomplete="off"
                                            class="layui-input"> -->
                                            <select name="sex" id="channelNameSelect">
                                                <option value=""></option>
                                                <option value="1">传统</option>
                                                <option value="2">电销</option>
                                                <option value="3">新车</option>
                                            </select>
                                        </div>
                                        <div class="layui-form-mid">结算方式:</div>
                                        <div class="layui-input-inline" style="width: 80px;">
                                            <select name="sex" id="settlementSelect">
                                                <option value=""></option>
                                                <option value="1">日结</option>
                                                <option value="2">月结</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="layui-row common">
                                        <div class="layui-form-mid">出单日期:</div>
                                        <div class="layui-input-inline" style="width: 100px;">
                                            <input type="text" class="layui-input" id="test1">
                                            <i class="layui-icon iconStyle">&#xe637;</i>
                                        </div>
                                        <div class="layui-form-mid">到</div>
                                        <div class="layui-input-inline" style="width: 100px;">
                                            <input type="text" class="layui-input" id="test2">
                                            <i class="layui-icon iconStyle"">&#xe637;</i>
                                        </div>
                                        <div class=" layui-form-mid">保单生效日期:</div>
                                        <div class="layui-input-inline" style="width: 100px;">
                                            <input type="text" class="layui-input" id="test3">
                                            <i class="layui-icon iconStyle">&#xe637;</i>
                                        </div>
                                        <div class="layui-form-mid">到</div>
                                        <div class="layui-input-inline" style="width: 100px;">
                                            <input type="text" class="layui-input" id="test4">
                                            <i class="layui-icon iconStyle">&#xe637;</i>
                                        </div>
                                        <div class="layui-form-mid">录入时间:</div>
                                        <div class="layui-input-inline" style="width: 100px;">
                                            <input type="text" class="layui-input" id="test5">
                                            <i class="layui-icon iconStyle">&#xe637;</i>
                                        </div>
                                        <div class="layui-form-mid">到</div>
                                        <div class="layui-input-inline" style="width: 100px;">
                                            <input type="text" class="layui-input" id="test6">
                                            <i class="layui-icon iconStyle">&#xe637;</i>
                                        </div>
                                        <div class="layui-form-mid">是否已提交:</div>
                                        <div class="layui-input-inline" style="width: 80px;">
                                            <select name="sex" id="isSubmitSelect">
                                                <option value=""></option>
                                                <option value="1">已提交</option>
                                                <option value="2">未提交</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="layui-row common">
                                        <div class="layui-form-mid">打款状态:</div>
                                        <div class="layui-input-inline" style="width: 80px;">
                                            <select name="sex" id="tabIsAuditing">
                                                <option value=""></option>
                                                <option value="1">有问题</option>
                                                <option value="2">未提交</option>
                                                <option value="3">预审中</option>
                                                <option value="4">审核中</option>
                                                <option value="5">预付中</option>
                                                <option value="6">付款中</option>
                                                <option value="7">已付款</option>
                                            </select>
                                        </div>
                                        <div class="layui-form-mid">打款时间:</div>
                                        <div class="layui-input-inline" style="width: 100px;">
                                            <input type="text" class="layui-input" id="test7">
                                            <i class="layui-icon iconStyle">&#xe637;</i>
                                        </div>
                                        <div class="layui-form-mid">到</div>
                                        <div class="layui-input-inline" style="width: 100px;">
                                            <input type="text" class="layui-input" id="test8">
                                            <i class="layui-icon iconStyle"">&#xe637;</i>
                                        </div>
                                        <div class=" layui-form-mid">保费收款状态:</div>
                                        <div class="layui-input-inline" style="width: 80px;">
                                            <select name="sex" id="tabAmountSate">
                                                <option value=""></option>
                                                <option value="1">已收</option>
                                                <option value="2">未收</option>
                                                <option value="3">已收全额</option>
                                                <option value="4">未收全额</option>
                                                <option value="5">已收净费</option>
                                                <option value="6">未收净费</option>
                                            </select>
                                        </div>
                                        <div class="layui-form-mid">团队名称:</div>
                                        <div class="layui-input-inline" style="width: 80px;">
                                            <select name="sex" id="teamsSelect">
                                                <option value=""></option>

                                            </select>
                                        </div>

                                        <div class="layui-form-mid">录入人:</div>
                                        <div class="layui-input-inline" style="width: 100px;">
                                            <select name="sex" id="whPersonSelect">
                                                <option value=""></option>

                                            </select>
                                        </div>

                                        <div class="layui-form-mid">转续保:</div>
                                        <div class="layui-input-inline" style="width: 80px;">
                                            <select name="sex" id="tabIsRenewal">
                                                <option value=""></option>
                                                <option value="1">续保</option>
                                                <option value="2">转保</option>
                                                <option value="3">新保</option>
                                            </select>
                                        </div>
                                        <!-- <div class="layui-form-mid">问题数据:</div>
                                    <div class="layui-input-inline" style="width: 100px;">
                                        <select name="sxfalg" id="sxfalg">
                                            <option value="">否</option>
                                            <option value="sx">是</option>
                                        </select>
                                    </div> -->
                                    </div>
                                    <!--                                <div class="layui-row layui-col-space10 btn-arr">-->
                                    <div class="layui-row layui-col-space10 btn-arr">
                                        <!--                                    <div class="layui-col-md9 layui-col-md-offset4">-->
                                        <div class="layui-col-md9 layui-col-md-offset6">
                                            <button style="border: none;"
                                                class="layui-btn layui-btn-primary layui-btn-sm" id="co">
                                                <i class="layui-icon">&#xe61f;</i>简洁模式
                                            </button>
                                            <!-- 间隔线条 -->
                                            <!-- <span
                                            style=" width: 0px; background-color: #000; display: inline-block;
                                         height: 15px; border-left: 1px solid #000; position: relative ; top: 5px;"></span> -->
                                            <span class="newSelect selectLeft" style="display: inline-flex; align-items: center; width: 72px;
                                                    margin-right: 8px;position: relative;top: 2px;">
                                                <button style="border: none;" id="jump"
                                                    class="layui-btn layui-btn-primary layui-btn-sm">
                                                    <i class="layui-icon">&#xe61f;</i>新建
                                                </button>
                                                <select name="city" lay-verify="required" class="select"
                                                    lay-filter="showDeadTime">
                                                    <option value="0" class="EditClass">编辑</option>
                                                    <option value="1">删除</option>
                                                </select>
                                            </span>
                                            <!-- 间隔线条 -->
                                            <!-- <span
                                            style=" width: 0px; background-color: #000; display: inline-block;
                                         height: 15px; border-left: 1px solid #000; position: relative ; top: 5px;"></span> -->
                                            <button style="border: none;" id="selectAll"
                                                class="layui-btn layui-btn-primary layui-btn-sm marginTop"
                                                onclick="selectAll()"><i class="layui-icon">&#xe61f;</i>全选
                                            </button>
                                            <!-- 间隔线条 -->
                                            <!-- <span
                                            style=" width: 0px; background-color: #000; display: inline-block;
                                         height: 15px; border-left: 1px solid #000; position: relative ; top: 5px;"></span> -->
                                            <!-- 提交按钮 -->
                                            <span class="newSelect newSubmit" style="display: inline-flex;  height: 30px; width: 72px;
                                                margin-right: 8px;position: relative;top: 5px;">
                                                <button style="border: none;"
                                                    class="layui-btn layui-btn-primary layui-btn-sm marginTop"
                                                    onclick="commitInsurance()"><i class="layui-icon">&#xe61f;</i>提交
                                                </button>
                                                <select name="city" lay-verify="required" class="select"
                                                    style="position: relative;top: 5px;" lay-filter="specialCommit">
                                                    <!-- <option></option> -->
                                                    <option value="0">特殊政策 </option>
                                                </select>
                                            </span>
                                            <!-- 间隔线条 -->
                                            <!-- <span style=" width: 0px; background-color: #000; display: inline-block;
                                        height: 15px; border-left: 1px solid #000; position: relative ; top: 5px;"></span> -->
                                            <button style="border: none;"
                                                class="layui-btn layui-btn-primary layui-btn-sm marginTop"><i
                                                    class="layui-icon">&#xe61f;</i>金额冲正
                                            </button>
                                            <button style="border: none;"
                                                class="layui-btn layui-btn-primary layui-btn-sm marginTop"
                                                onclick="openExportDiv()">
                                                <i class="layui-icon">&#xe61f;</i>导出CSV
                                            </button>
                                            <button style="border: none;"
                                                class="layui-btn layui-btn-primary layui-btn-sm marginTop"
                                                onclick="document.getElementById('light').style.display='block';"><i
                                                    class="layui-icon">&#xe61f;</i>一键导入
                                            </button>
                                            <button style="border: none;" id="seach"
                                                class="layui-btn layui-btn-primary layui-btn-sm marginTop">
                                                <i class="layui-icon">&#xe615;</i>搜索
                                            </button>
                                            <!-- <button class="layui-btn layui-btn-primary layui-btn-sm" id="seach1">
                                           <i class="layui-icon">&#xe61f;</i>筛选问题数据
                                    </button> -->
                                            <!-- <button  id="testUp1" id="testUp1" class="layui-btn layui-btn-primary layui-btn-sm"><i class="layui-icon">&#xe615;</i>导入表单</button> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <table id="demo" lay-filter="test1"></table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--保单新增/编辑-->
    <div id="prompt" class="layui-fluid" style="display: none;">
        <div class="layui-row layui-col-space10" style="margin-top: 1px;">
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">业务编号:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tabBusinessID1" autocomplete="off" disabled class="layui-input">
                    <input type="text" id="pistId" autocomplete="off" style="display: none" class="layui-input">
                </div>
            </div>
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">代理人:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input id="tabAgentName1" type="text" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">客户电话:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input id="tabCustomerMobile1" type="text" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">车牌:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tabCarNum1" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">客户姓名:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="sPerson" autocomplete="off" class="layui-input">
                </div>
            </div>
        </div>
        <div class="layui-row layui-col-space10" style="margin-top: 1px;">
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">团队:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="teamsSelect1" autocomplete="off" class="layui-input">
                    <!-- <select name="sex" class="layui-select-s" id="teamsSelect1">
                <option value=""></option>

    </select> -->
                </div>
            </div>

            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">渠道:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tabChannel1" autocomplete="off" class="layui-input">
                    <!-- 	<select name="sex" id="tabChannel1" class="layui-select-s">
                <option value=""></option>
                <option value="1">传统</option>
                <option value="2">非传统</option>
                <option value="2">其他</option>
            </select> -->
                </div>
            </div>
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">使用性质:</div>
                <div class="layui-input-inline layui-input-inline-width">

                    <input type="text" id="tabCarState1" autocomplete="off" class="layui-input">
                    <!-- 	<select name="sex" id="tabCarState1" class="layui-select-s">
                <option value=""></option>
                <option value="1">客车</option>
                <option value="2">非客车</option>
            </select> -->
                </div>
            </div>
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">业务性质:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tabBusinessNature1" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">转续保:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tabIsRenewal1" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-col-md4" style="display: none">
                <div class="layui-form-mid layui-form-mid-width">险种:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tabYxState1" autocomplete="off" class="layui-input">
                    <!-- <select name="sex" id="tabYxState1"  class="layui-select-s">
                <option value=""></option>
                <option value="1">交强险</option>
                <option value="2">商业险</option>
            </select> -->

                </div>
            </div>
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">保险公司:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="gsName" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">结算方式:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="payState" autocomplete="off" class="layui-input">
                    <!-- <select name="sex" class="layui-select-s">
                <option value="1">1</option>
                <option value="2">2</option>
            </select> -->
                </div>
            </div>

            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">批单日期:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" class="layui-input" id="test91">

                </div>
            </div>
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">生效日期:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" class="layui-input" id="test101">

                </div>
            </div>

            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">失效日期:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" class="layui-input" id="test111">

                </div>
            </div>
        </div>
        <div class="layui-row layui-col-space10" style="margin-top: 1px;">

            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">商业险:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="syx" autocomplete="off" onkeyup="allAmount1()" class="layui-input">
                </div>
            </div>
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">交强险:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="jqx" autocomplete="off" onkeyup="allAmount1()" class="layui-input">
                </div>
            </div>
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">车船税:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="ccs" autocomplete="off" onkeyup="allAmount1()" class="layui-input">
                </div>
            </div>


            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">交强费用率(小数):</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tab_jqfyl" autocomplete="off" onkeyup="allAmount2()" class="layui-input">
                </div>
            </div>

            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">商业费用率(小数):</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tab_syfyl" autocomplete="off" onkeyup="allAmount2()" class="layui-input">
                </div>
            </div>

        </div>
        <div class="layui-row layui-col-space10" style="margin-top: 1px;">
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">实收:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="shishou1" autocomplete="off" disabled class="layui-input">
                    <!-- <select name="sex" id="ifxbSelect" class="layui-select-s">
                <option value=""></option>
                <option value="1">是</option>
                <option value="2">否</option>

            </select> -->
                </div>
            </div>

            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">其他佣金:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="qitayongjin1" autocomplete="off" onkeyup="allAmount2()" class="layui-input">
                    <!-- <select name="sex" id="hSelect" class="layui-select-s">
                <option value=""></option>
                <option value="1">2吨以下</option>
                <option value="2">5吨以下</option>
                <option value="3">10吨以下</option>
                    <option value="4">15吨以下</option>
            </select> -->

                </div>
            </div>
            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">佣金合计:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="xj" autocomplete="off" disabled class="layui-input">

                </div>
            </div>

            <div class="layui-col-md4" style="display: none">
                <div class="layui-form-mid layui-form-mid-width">交强险净保费:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tab_ygzhjq_amount1" autocomplete="off" disabled class="layui-input">
                </div>
            </div>

            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">交强净保费:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tab_jqjbf" autocomplete="off" disabled class="layui-input">
                </div>
            </div>

            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">商业净保费:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tab_syjbf" autocomplete="off" disabled class="layui-input">
                </div>
            </div>


            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">交强险费用:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tab_jqxfy" autocomplete="off" disabled class="layui-input">
                </div>
            </div>

            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">商业险费用:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tab_syxfy" autocomplete="off" disabled class="layui-input">
                </div>
            </div>

            <div class="layui-col-md4" style="display: none">
                <div class="layui-form-mid layui-form-mid-width">商业险净保费:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tab_ygzhsy_amount1" autocomplete="off" disabled class="layui-input">
                </div>
            </div>

            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">小计:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="allAmount1" autocomplete="off" disabled class="layui-input">
                </div>
            </div>
            <div class="layui-col-md4" style="display: none">
                <div class="layui-form-mid layui-form-mid-width">净费应收:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="jfys" autocomplete="off" class="layui-input">
                </div>
            </div>

            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">保费收款状态:</div>
                <div class="layui-input-inline layui-input-inline-width">

                    <input type="text" id="tabAmountSate1" autocomplete="off" class="layui-input">
                    <!-- <select name="sex" id="tabAmountSate1" class="layui-select-s">
                <option value=""></option>
                <option value="1">已收</option>
                <option value="2">未付</option>
            </select> -->
                </div>
            </div>

            <div class="layui-col-md4">
                <div class="layui-form-mid layui-form-mid-width">录入人:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="writePerson1" autocomplete="off" class="layui-input">
                </div>
            </div>

        </div>
        <div class="layui-row layui-col-space10" style="margin-top: 1px;">

            <div class="layui-col-md4" style="display: none">
                <div class="layui-form-mid layui-form-mid-width">净保费交强率:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tab_jbfjql1" autocomplete="off" class="layui-input">
                </div>
            </div>

            <div class="layui-col-md4" style="display: none">
                <div class="layui-form-mid layui-form-mid-width">净保费商业率:</div>
                <div class="layui-input-inline layui-input-inline-width">
                    <input type="text" id="tabJbfsyl1" autocomplete="off" class="layui-input">
                </div>
            </div>


        </div>
        <div class="layui-row layui-col-space10" style="margin-top: 1px;">
            <div class="layui-col-md4" style="display: none">
                <div class="layui-form-mid layui-form-mid-width">总保费/净费:</div>
                <div class="layui-input-inline layui-input-inline-width">

                    <input type="text" id="tab_zbf_j1" autocomplete="off" class="layui-input">
                    <!-- <select name="sex" id="tabAmountSate1" class="layui-select-s">
                <option value=""></option>
                <option value="1">已收</option>
                <option value="2">未付</option>
            </select> -->
                </div>
            </div>

        </div>
        <div class="layui-row layui-col-space10" style="margin-top: 1px;">
            <label class="layui-form-label">备注：</label>
            <div class="layui-input-block">
                <textarea name="desc" placeholder="" id="tabMessage1" class="layui-textarea"></textarea>
            </div>
            <label class="layui-form-label">备用：</label>
            <div class="layui-input-block">
                <textarea name="desc" placeholder="" id="tabReserve" class="layui-textarea"></textarea>
            </div>
            <label class="layui-form-label">说明：</label>
            <div class="layui-input-block">
                <textarea name="desc" placeholder="" id="tabIllustrate" class="layui-textarea"></textarea>
            </div>
            <label class="layui-form-label">事项：</label>
            <div class="layui-input-block">
                <textarea name="desc" placeholder="" id="tabItems" class="layui-textarea"></textarea>
            </div>
        </div>

        <!-- 		<div class="layui-upload-drag" id="testUp">
<i class="layui-icon"></i>
<p>点击上传，或将文件拖拽到此处</p>
<blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;width: 88%">
预览图：
<div class="layui-upload-list uploader-list" style="overflow: auto;" id="demo2">

</div>
</blockquote>
</div> -->

        <div class="layui-upload">
            <button type="button" class="layui-btn" id="testUp">附件上传</button>

            <blockquote id="demo12" class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;width: 100%">
                <div id="layer-photos-demo" class="layer-photos-demo">
                    <div class="layui-upload-list uploader-list" style="overflow: auto;" id="demo2">


                    </div>

                </div>
            </blockquote>
        </div>
    </div>
    <input type="hidden" id="hidden_trainSchemeId">
    <!--
<div class="layui-row layui-col-space10" style="margin-top: 1px;">
    <label class="layui-form-label">文件上传：</label>
    <button type="button" class="layui-btn" id="testUp">
      <i class="layui-icon">&#xe67c;</i>附件上传
    </button>
         <blockquote class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;">

          <div class="layui-upload-list" id="demo2"></div>
   </blockquote>
</div> -->

    <!-- <div class="layui-row layui-col-space10">
  <div class="layui-col-md8 layui-col-md-offset4">
      <div class="layui-input-block">
      <button class="layui-btn" lay-submit lay-filter="formDemo">立即提交</button>
      <button type="reset" class="layui-btn layui-btn-primary">取消</button>
    </div>
  </div>
</div> -->

    <div id="waitDiv"
        style="display:none;position: absolute;top:40%;left:40%;width: auto;height: auto;background-color: #F7F7F7;border-radius: 8px 8px 8px 8px;"
        align="center">
        <div style="font-size: 20px;margin: 8px 5px;">
            <span>您是想导出勾选数据，还是想导出所有的数据呢？</span><br><br>
            <button onclick="exportCSV(0)" style="padding: 1px 1px;">所有的
            </button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button onclick="exportCSV(1)" style="padding: 1px 1px;">勾选的
            </button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button onclick="exportCSV(2)" style="padding: 1px 1px;">关&nbsp;&nbsp;闭</button>
        </div>
        <div id="exportTips" style="display: none;">
            <br>
            <div style="height: 1px;background-color: #8E8E8E;"></div>
            <br>
            <span style="text-align: center;font-size: 30px;color: #8E8E8E;">正在导出...</span>
            <br>
            <br>
        </div>
    </div>
    <!-- 用来显示详情的数据 -->
    <div id="showDetail" style="display: none;">
        <!-- 第一行数据 -->
        <div class="layui-row">
            <div class="layui-row">
                <div class="layui-col-md9">
                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md4">
                        业务编号：<span id="detail-1-1"></span>
                    </div>
                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md4">
                        代理人姓名：<span id="detail-1-2"></span>
                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        车牌：<span id="detail-1-3"></span>
                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        电话：<span id="detail-2-1"></span>
                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        客户姓名：<span id="detail-2-2"></span>
                    </div>
                </div>
                <div class="layui-col-md3">
                    保险公司：<span id="detail-2-3"></span>
                </div>
            </div>
            <hr />
            <!-- 第二行数据 -->
            <div class="layui-row">
                <div class="layui-col-md9">
                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md4">
                        渠道：<span id="detail-3-1"></span>
                    </div>
                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md4">
                        使用性质：<span id="detail-3-2"></span>
                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        业务性质：<span id="detail-3-3"></span>
                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        团队：<span id="detail-10-1"></span>
                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        结算方式：<span id="detail-10-2"></span>
                    </div>
                </div>
                <div class="layui-col-md3">
                    保险生效日期：<span id="detail-4-2"></span>
                </div>
            </div>
            <hr />

            <!-- 第三行数据 -->
            <div class="layui-row">
                <div class="layui-col-md9">
                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md4">
                        出单日期：<span id="detail-4-1"></span>
                    </div>
                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md4">
                        转续保：<span id="detail-10-3"></span>

                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        小计：<span id="detail-6-3"></span>
                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        商业险：<span id="detail-5-1"></span>
                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        交强险：<span id="detail-5-2"></span>
                    </div>
                </div>
                <div class="layui-col-md3">
                    车船税：<span id="detail-5-3"></span>
                </div>
            </div>
            <hr />

            <!-- 第四行数据（插入） -->
            <div class="layui-row">
                <div class="layui-col-md9">
                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md4">
                        商业净保费：<span id="detail-7-1"></span>
                    </div>
                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md4">
                        商业费用率：<span id="detail-7-2"></span>
                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        商业险费用：<span id="detail-7-3"></span>
                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        其它佣金：<span id="detail-6-1"></span>
                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        佣金合计：<span id="detail-6-2"></span>
                    </div>
                </div>
                <div class="layui-col-md3">
                    保险失效日期：<span id="detail-4-3"></span>

                </div>
            </div>
            <hr />

            <!-- 第四行数据 -->
            <div class="layui-row">
                <div class="layui-col-md9">
                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md4">
                        交强净保费：<span id="detail-8-1"></span>
                    </div>
                    <div class="layui-col-xs6 layui-col-sm6 layui-col-md4">
                        交强费用率：<span id="detail-8-2"></span>
                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        交强险费用：<span id="detail-8-3"></span>
                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        保费收款状态：<span id="detail-9-1"></span>
                    </div>
                    <div class="layui-col-xs4 layui-col-sm12 layui-col-md4">
                        是否已提交：<span id="detail-9-2"></span>
                    </div>
                </div>
                <div class="layui-col-md3">
                    录入人：<span id="detail-9-3"></span>
                </div>
            </div>
            <hr />

            <!-- 第五行数据 -->
            <div class="layui-row">
                <div class="layui-col-md6">
                    备注：<span id="detail-11-1"></span>
                </div>
                <div class="layui-col-md6">
                    备用：<span id="detail-11-2"></span>
                </div>
            </div>
            <hr />

            <!-- 第六行数据 -->
            <div class="layui-row">
                <div class="layui-col-md6">
                    说明：<span id="detail-11-3"></span>
                </div>
                <div class="layui-col-md6">
                    事项：<span id="detail-11-4"></span>

                </div>
            </div>
            <hr />
            <br />
            <br />
            <!-- 详情图片上传 -->
            <div class="layui-upload">
                <h3 style="margin-left: 40px; font-size: 25px;;">附件：</h3>
                <blockquote id="demo121" class="layui-elem-quote layui-quote-nm" style="margin-top: 2px;width: 100%">
                    <div id="layer-photos-demo1" class="layer-photos-demo">
                        <div class="layui-upload-list uploader-list" style="overflow: auto;" id="demo3">
                        </div>
                    </div>
                </blockquote>
            </div>
        </div>
        <input type="hidden" id="hidden_trainSchemeId1">


    </div>


    <div id="light" class="white_content" align="center" style="text-align: center;line-height: 100%; ">
        <form method="post" enctype="multipart/form-data">
            <!-- <h3>批量导入</h3> -->
            <!-- <span style="text-align: center;display:block; font-size: 25px;">批量导入</span><br /> -->
            <span class="importStyle">批量导入</span><br />
            <hr />
            <span class="chooseFile">请选择文件(xls)：
                <!--            <input type="file" name="insurancefile" id="insurancefile">-->
                <button type="button" class="layui-btn layui-btn-sm" id="importiInsurance">保单表格上传</button>
            </span><br />
            <span style="text-align: center;display:block; margin-top: 15px;">
                <button type="button" class="layui-btn layui-btn-sm layui-btn-normal" onclick="getSure()">确认</button>
                <button type="button" class="layui-btn layui-btn-sm layui-btn-warm"
                    onclick="getTemplate()">下载模板</button>
                <!--                    <button type="button" class="layui-btn layui-btn-sm layui-btn-primary"-->
                <!--                            onclick="document.getElementById('light').style.display='none';">取消</button>-->
                <!-- <input  type="submit" value="确    认">&nbsp;&nbsp;&nbsp;&nbsp;
        <input type="button" value="下载模板" onclick="getTemplate()">&nbsp;&nbsp;&nbsp;&nbsp;
        <input type="button" onclick="document.getElementById('light').style.display='none';" value="取    消"> -->
            </span>
        </form>
        <div id="waitDiv2" align="left" style="display:none;position: absolute;width: 100%;height: 100%;">
            <br>
            <div style="height: 1px;background-color: #8E8E8E;"></div>
            <br>
            导入日志：<br><br>
        </div>
    </div>
    <div id="fade" class="black_overlay"></div>


    <div id="imgView" class="layui-fluid" style="display: none;">

        <img id="imgs" alt="" src="">

    </div>
    <script type="text/html" id="barDemo">
    <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>
    <!-- <script src="../assets/layui.all.js"></script> -->
    <script src="../newLayui/layui/layui.all.js"></script>
    <script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>

    <script>

        //文件基础路径
        // var fileBaseAdress = "http://125.124.131.34:9090/yxbx/files/";
        var fileBaseAdress = "http://localhost:8082/yxbx/files/";

        //下载导入模板
        function getTemplate() {
            location.href = "../files/ImportTemplate/ImportTemplate.xls";
        }

        //一键导入
        layui.use('upload',
            function () {
                var upload = layui.upload;
                userInfo = JSON.parse(localStorage.getItem("userInfo"));
                //执行实例
                var importIns = upload.render({
                    elem: '#importiInsurance',
                    url: '/yxbx/importiInsurance',
                    multiple: true, //多文件上传
                    number: 100,
                    accept: 'file',
                    exts: 'xls',
                    /*   auto: false                                 //自动上传,默认是打开的
                     , bindAction: '#btnUpload'                    //auto为false时，点击触发上传
                     , multiple: true                             //多文件上传
                     , number: 100 ,                              //multiple:true时有效 */
                    before: function (obj) {
                        this.data = {
                            "userId": userInfo.userId,
                            "username": userInfo.username
                        }; //携带额外的数据
                        layer.msg('文件上传中...', {
                            icon: 16,
                            shade: 0.01,
                            time: 0
                        });
                    },
                    done: function (res) {
                        layer.close(layer.index);
                        $('#waitDiv2').append(res.msg);
                        $("#waitDiv2").show();
                    },
                    error: function () {
                        //请求异常回调
                        alert("请求失败！");
                    }
                });
            }
        );

        //提交
        function commitInsurance() {
            userInfo = JSON.parse(localStorage.getItem("userInfo"));
            var idStr = "";
            for (var i = 0; i < checkitemIds.length; i++) {
                idStr += checkitemIds[i];
                if (i !== checkitemIds.length - 1) {
                    idStr += ",";
                }
            }
            $.ajax({
                url: "/yxbx/commitManyInsuranceTabIsAuditing",
                type: 'POST',
                async: false, //这得注意是同步
                data: {
                    'userId': userInfo.userId,
                    'idStr': idStr
                },
                success: function (res) {
                    var data = eval('(' + res + ')');
                    alert(data.msg);
                },
                error: function (res) {
                    alert("请求失败！");
                    console.log(res);
                }
            });
        }

        //特殊政策提交
        function commitSpecialInsurance() {
            userInfo = JSON.parse(localStorage.getItem("userInfo"));
            var idStr = "";
            for (var i = 0; i < checkitemIds.length; i++) {
                idStr += checkitemIds[i];
                if (i !== checkitemIds.length - 1) {
                    idStr += ",";
                }
            }
            $.ajax({
                url: "/yxbx/commitSpecialInsuranceTabIsAuditing",
                type: 'POST',
                async: false, //这得注意是同步
                data: {
                    'userId': userInfo.userId,
                    'idStr': idStr
                },
                success: function (res) {
                    var data = eval('(' + res + ')');
                    alert(data.msg);
                },
                error: function (res) {
                    alert("请求失败！");
                    console.log(res);
                }
            });
        }

        //计算总保费
        function allAmount1() {
            var syx = Number($("#syx").val());
            var jqx = Number($("#jqx").val());
            var ccs = Number($("#ccs").val());
            var jqfyl = Number($("#tab_jqfyl").val());
            var syfyl = Number($("#tab_syfyl").val());
            $("#allAmount1").val(syx + jqx + ccs);
            $("#tab_jqjbf").val((jqx / 1.06).toFixed(2));
            $("#tab_syjbf").val((syx / 1.06).toFixed(2));
        }

        //计算佣金合计
        function allAmount2() {
            var jqjbf = Number($("#tab_jqjbf").val());
            var syjbf = Number($("#tab_syjbf").val());
            var jqfyl = Number($("#tab_jqfyl").val());
            var syfyl = Number($("#tab_syfyl").val());
            var qt = Number($("#qitayongjin1").val());
            $("#xj").val(jqjbf * jqfyl + syjbf * syfyl + qt);
            $("#tab_jqxfy").val((jqjbf * jqfyl).toFixed(2));
            $("#tab_syxfy").val((syjbf * syfyl).toFixed(2));
        }

        var timer = null;

        function renderForm() {
            layui.use('form', function () {
                var form = layui.form; //高版本建议把括号去掉，有的低版本，需要加()
                form.render();
            });
        }

        function bd(data) {
            var select = document.getElementById("teamsSelect");
            select.options.length = 0;
            select.options.add(new Option("", ""));
            for (var i = 0; i < data.length; i++) {
                select.options.add(new Option(data[i].tabTeamName, data[i].id));
            }
            var form = layui.form;
            renderForm();
        }

        function bd1(data) {
            /*   var select = document.getElementById("AgentSelect");
                           select.options.length=0;
                        select.options.add(new Option("",""));
                       for(var i = 0;i<data.length;i++){
                            select.options.add(new Option(data[i].tabAgentName,data[i].tabAgentId));
                       }
                        var form = layui.form;
                        renderForm(); */
        }

        function bd2(data) {
            var select = document.getElementById("insuranceSelect");
            select.options.length = 0;
            select.options.add(new Option("", ""));
            for (var i = 0; i < data.length; i++) {
                select.options.add(new Option(data[i].tabInsurerName, data[i].id));
            }
            var form = layui.form;
            renderForm();
        }

        $(".layui-table-box").click(function () {
            alert(1);
        });
        // select监听事件
        var form = layui.form;
        //新建的下拉框
        form.on('select(showDeadTime)', function (data) {
            if (data.value === "0") {
                editItem();
            } else if (data.value === "1") {
                deleteItem();
            }
        });
        //提交的下拉框
        form.on('select(specialCommit)', function (data) {
            if (data.value === "0") {
                commitSpecialInsurance();
            }
        });
        // 简洁模式
        $("#co").click(function () {
            $('table.layui-table thead tr th:eq(1)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabQdDate']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(2)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabEndDate']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(6)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabBusinessNature']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(7)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabIsRenewal']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(8)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabCarState']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(18)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabMessage']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(19)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabManagerUser']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(20)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabWhPerson']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(21)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabCustomerMobile']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(22)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabJqjbf']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(24)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabJqxfy']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(25)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabSyjbf']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(27)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabSyxfy']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(28)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabCommissionOther']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(29)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabCommissionAmount']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(30)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabIsAuditing']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(33)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabWriteDate']").toggleClass('layui-hide');//数据栏
            $('table.layui-table thead tr th:eq(35)').toggleClass('layui-hide');//标题栏
            $("table.layui-table tbody tr td[data-field='tabBusinessID']").toggleClass('layui-hide');//数据栏
        });
        // 除了第一个点击的时候都添加样式

        $("table.layui-table tbody tr:eq(0)").click(function () {
            alert(1);
            $(this).toggleClass(active);
        });
        //除了表头（第一行）以外所有的行添加click事件.
        $("tr").first().nextAll().click(function () {
            //如果没有某个样式则加上，否则去除
            $(this).children().toggleClass(active);
            if ($(this).children().hasClass(active)) {//如果有某个样式则表明，这一行已经被选中
                $(this).children().first().children().attr("checked", true);
            } else {                                  //如果没有被选中
                $(this).children().first().children().attr("checked", false);
            }
        });


        function bd3(data) {
            var select = document.getElementById("whPersonSelect");
            select.options.length = 0;
            select.options.add(new Option("", ""));
            for (var i = 0; i < data.length; i++) {
                select.options.add(new Option(data[i].tabUsername, data[i].tabUserId));
            }
            var form = layui.form;
            renderForm();
        }

        bSelect('/yxbx/findAgent', 1000000000, 1);
        bSelect('/yxbx/queryInsurance', 1000000000, 2);
        bSelect('/yxbx/findTeam', 1000000000, 3);
        bSelect('/yxbx/queryAllUser', 1000000000, 4);

        function bSelect(url, params, type) {
            userInfo = JSON.parse(localStorage.getItem("userInfo"));
            $.ajax({
                url: url,
                type: 'POST',
                async: false, //这得注意是同步
                data: {
                    'pageSize': params,
                    'userId': userInfo.userId,
                    'sxfalg': "1"
                },
                success: function (res) {
                    var data = eval('(' + res + ')');
                    if (data.msg === '权限不足') {
                        alert('您的权限为' + userInfo.user_type + ',您只能增加比它大的用户权限');
                    } else if (data.code === 0) {
                        //$('#teams1 option:selected') .val();
                        //alert($('#teams1 option:selected') .val());

                        var se = data.data;
                        if (se != null) {
                            if (type === 1) {
                                bd1(se);
                            } else if (type === 2) {
                                bd2(se);
                            } else if (type === 3) {
                                bd(se);
                            } else if (type === 4) {
                                bd3(se);
                            }
                        }
                    } else {
                        alert(data.msg);
                    }
                },
                error: function (res) {
                    alert("请求失败！");
                    console.log(res);
                }
            });
        }

        var element = layui.element;
        var table = layui.table;
        var form = layui.form;
        /* //上传
        layui.use('upload', function(){
          var upload = layui.upload;

          //执行实例
          var uploadInst = upload.render({
            elem: '#testUp',
            url: '/yxbx/uploadfile',
            data: {
                'userId':userId,
                'trueSId':trueSId

            },
            done: function(res){
              //上传完毕回调
            }
            ,error: function(){
              //请求异常回调
            }
          });
        }); */
        //弹出层
        layui.use('layer', function () {
            var $ = layui.jquery,
                layer = layui.layer;
            // 点击搜索调用的方法
            $(document).on('click', '#seach', function () {
                var yId = $("#yId").val();
                var businessID = $("#businessID").val(); //业务编码
                var agentId = $("#Agentpo").val(); //代理人
                var tabSafePerson = $("#tabSafePerson").val(); //客户
                var tabCarNum = $("#tabCarNum").val(); //车牌
                var nature = $("#natureSelect").find("option:selected").text(); //使用性质
                var tabYxState = $("#tabYxState").find("option:selected").text(); //险种
                var insurerId = $("#insuranceSelect").find("option:selected").text(); //保险公司
                var channelName = $("#channelNameSelect").find("option:selected").text(); //渠道
                var tabAgentPay = $("#settlementSelect").find("option:selected").text(); //结算方式
                var tabStartDateStart = $("#test1").val(); //出单日期开始
                var tabStartDateEnd = $("#test2").val(); //出单日期结束
                var tabQdDateStart = $("#test3").val(); //生效日期开始
                var tabQdDateEnd = $("#test4").val(); //生效日期结束
                var tab_write_date_start = $("#test5").val(); //录入日期开始
                var tab_write_date_end = $("#test6").val(); //录入日期结束
                var tabIsCommit = $("#isSubmitSelect").find("option:selected").text(); //是否已提交
                var tabIsAuditing = $("#tabIsAuditing").find("option:selected").text(); //打款状态
                var tabPayDateStart = $("#test7").val(); //打款时间开始
                var tabPayDateEnd = $("#test8").val(); //打款时间结束
                var tabAmountSate = $("#tabAmountSate").find("option:selected").text(); //保费收款状态
                var teamId = $("#teamsSelect").find("option:selected").text(); //团队名称
                // var sxfalg = $("#sxfalg").val();
                // var quality = $("#qualitySelect").find("option:selected").text();
                // // var insurerId =$('#insuranceSelect option:selected') .val();
                var whPersonSelect = $("#whPersonSelect").find("option:selected").text();//录入人
                var tabIsRenewal = $("#tabIsRenewal").find("option:selected").text();//转续保
                // userInfo = JSON.parse(localStorage.getItem("userInfo"));
                // /* 	var	endTimeStart=$("#test20").val()+"  00:00:00";//生效时间
                // 	var	endTimeEnd=$("#test20").val()+"  00:00:00";//生效时间 */

                var jsonStr = "{";
                if (yId !== "") {
                    jsonStr = jsonStr + "\"id\":" + yId;
                }
                if (businessID !== "") {
                    jsonStr = jsonStr + ",\"tabBusinessID\":" + businessID;
                }
                if (agentId !== "") {
                    jsonStr = jsonStr + ",\"tabAgentName\":" + agentId;
                }
                if (tabSafePerson !== "") {
                    jsonStr = jsonStr + ",\"tabSafePerson\":" + tabSafePerson;
                }
                if (tabCarNum !== "") {
                    jsonStr = jsonStr + ",\"tabCarNum\":" + tabCarNum;
                }
                if (nature !== "") {
                    jsonStr = jsonStr + ",\"tabCarState\":" + nature;
                }
                if (tabYxState !== "") {
                    jsonStr = jsonStr + ",\"tabYxState\":" + tabYxState;
                }
                if (insurerId !== "") {
                    jsonStr = jsonStr + ",\"tabInsuranceCompanyName\":" + insurerId;
                }
                if (channelName !== "") {
                    jsonStr = jsonStr + ",\"tabChannel\":" + channelName;
                }
                if (tabAgentPay !== "") { //新增的結算方式
                    jsonStr = jsonStr + ",\"tabAgentPay\":" + tabAgentPay;
                }
                if (tabStartDateStart !== "") {
                    jsonStr = jsonStr + ",\"tabStartDateStart\":\"" + tabStartDateStart + "  00:00:00\"";
                }
                if (tabStartDateEnd !== "") {
                    jsonStr = jsonStr + ",\"tabStartDateEnd\":\"" + tabStartDateEnd + " 24:00:00\"";
                }
                if (tabQdDateStart !== "") {
                    jsonStr = jsonStr + ",\"tabQdDateStart\":\"" + tabQdDateStart + " 00:00:00\"";
                }
                if (tabQdDateEnd !== "") {
                    jsonStr = jsonStr + ",\"tabQdDateEnd\":\"" + tabQdDateEnd + " 24:00:00\"";
                }
                if (tab_write_date_start !== "") {
                    jsonStr = jsonStr + ",\"tab_write_date_start\":\"" + tab_write_date_start + " 00:00:00\"";
                }
                if (tab_write_date_end !== "") {
                    jsonStr = jsonStr + ",\"tab_write_date_end\":\"" + tab_write_date_end + " 24:00:00\"";
                }
                if (tabIsCommit !== "") { //新增的  是否已提交
                    jsonStr = jsonStr + ",\"tabIsCommit\":" + tabIsCommit;
                }
                if (tabIsAuditing !== "") {
                    jsonStr = jsonStr + ",\"tabIsAuditing\":" + tabIsAuditing;
                }
                if (tabPayDateStart !== "") {
                    jsonStr = jsonStr + ",\"tabPayDateStart\":\"" + tabPayDateStart + " 00:00:00\"";
                }
                if (tabPayDateEnd !== "") {
                    jsonStr = jsonStr + ",\"tabPayDateEnd\":\"" + tabPayDateEnd + " 24:00:00\"";
                }
                if (tabAmountSate !== "") {
                    jsonStr = jsonStr + ",\"tabAmountSate\":" + tabAmountSate;
                }
                if (teamId !== "") {
                    jsonStr = jsonStr + ",\"tabTeamOwnership\":" + teamId;
                }
                if (whPersonSelect !== "") {
                    jsonStr = jsonStr + ",\"tabWhPerson\":" + whPersonSelect;
                }
                if (tabIsRenewal !== "") {
                    jsonStr = jsonStr + ",\"tabIsRenewal\":" + tabIsRenewal;
                }
                // if (sxfalg != "") {
                // 	jsonStr = jsonStr + ",\"sxfalg\": " + sxfalg;
                // }
                if (jsonStr !== "{") {
                    jsonStr = jsonStr + "}";
                } else {
                    jsonStr = null;
                }

                //	var jsonStr="{"id":102,"tabCarNum":"浙CEJ688","tabSafePerson":"彭成帮","tabYxState":"超级帅气","tabCarState":"客车","tabChannel":"平阳永顺","tabInsuranceCompanyName":"龙港太保","tabCdPerson":"吴玉修","tabWhPerson":"李学聪","tabAgentName":"杨思伟杨宗波","tabAmountSate":"已收","tabTeamOwnership":"杨思伟"}"
                userInfo = JSON.parse(localStorage.getItem("userInfo"));
                tableIns.reload({
                    method: 'POST',
                    where: { //设定异步数据接口的额外参数，任意设
                        SeachInsuranceJsonStr: jsonStr,
                        userId: userInfo.userId,
                        sxfalg: "1"
                    },
                    page: {
                        curr: 1
                        //重新从第 1 页开始
                    }
                });
            });
            $(document).on('click', '#jump', function () {
                layer.open({
                    type: 1,
                    title: [
                        '新增',
                        'font-size:18px;'
                    ],
                    content: $('#prompt'),
                    skin: 'layui-layer-rim',
                    area: [
                        '1310px',
                        '800px'
                    ],
                    resize: false,
                    end: function () {
                        $("#prompt").hide();
                        $('.demo34').parent().remove();
                        $('.info').parent().remove();
                    },
                    btn: [
                        '提交',
                        '关闭'
                    ],
                    yes: function (index, layero) {
                        //  var jsonStr="{"id":102,"tabCarNum":"浙CEJ688","tabSafePerson":"彭成帮","tabYxState":"超级帅气","tabCarState":"客车","tabChannel":"平阳永顺","tabInsuranceCompanyName":"龙港太保","tabCdPerson":"吴玉修","tabWhPerson":"李学聪","tabAgentName":"杨思伟杨宗波","tabAmountSate":"已收","tabTeamOwnership":"杨思伟"}";
                        var channelName = $("#tabChannel1").val();
                        var nature = $(
                            "#tabCarState1")
                            .val();
                        //  var quality  = $("#qualitySelect").find("option:selected").text();
                        // var insurerId =$('#insuranceSelect option:selected') .val();
                        //var insurerId = $("#insuranceSelect").find("option:selected").text();
                        var agentId = $("#tabAgentName1").val();
                        var tabBusinessNature = $("#tabBusinessNature1").val();
                        var tabIsRenewal = $("#tabIsRenewal1").val();
                        var tab_jqfyl = $("#tab_jqfyl").val();
                        var tab_syfyl = $("#tab_syfyl").val();
                        var tab_jqjbf = $("#tab_jqjbf").val();
                        var tab_syjbf = $("#tab_syjbf").val();
                        var tab_jqxfy = $("#tab_jqxfy").val();
                        var tab_syxfy = $("#tab_syxfy").val();
                        var tabIllustrate = $("#tabIllustrate").val();
                        var tabReserve = $("#tabReserve").val();
                        var tabItems = $("#tabItems").val();
                        var teamId = $(
                            "#teamsSelect1")
                            .val();
                        var whPersonSelect = $("#whPersonSelect").find("option:selected").text();
                        userInfo = JSON
                            .parse(localStorage
                                .getItem("userInfo"));
                        var tabSafePerson = $(
                            "#sPerson")
                            .val(); //客户
                        var yId = $(
                            "#yId")
                            .val(); //业务编码
                        var tabCarNum = $(
                            "#tabCarNum1")
                            .val(); //车牌
                        var tabYxState = $(
                            "#tabYxState1")
                            .val(); //险种
                        var tabStartDate = $(
                            "#test91")
                            .val(); //出单日期
                        var tabQdDate = $(
                            "#test101")
                            .val(); //生效时间结束
                        var tabEndDate = $(
                            "#test111")
                            .val(); //失效时间结束
                        var payState = $(
                            "#payState")
                            .val(); //付款方式
                        var tabAmountSate1 = $(
                            "#tabAmountSate1")
                            .val(); //收款状态
                        var tabMessage1 = $(
                            "#tabMessage1")
                            .val(); //备注
                        var jfys = $(
                            "#jfys")
                            .val(); //
                        var tab_ygzhjq_amount1 = $(
                            "#tab_ygzhjq_amount1")
                            .val(); //
                        var tab_ygzhsy_amount1 = $(
                            "#tab_ygzhsy_amount1")
                            .val(); //
                        var tab_jbfjql1 = $(
                            "#tab_jbfjql1")
                            .val(); //
                        var tabJbfsyl1 = $(
                            "#tabJbfsyl1")
                            .val(); //
                        var tab_zbf_j1 = $(
                            "#tab_zbf_j1")
                            .val(); //
                        var tabCustomerMobile1 = $(
                            "#tabCustomerMobile1")
                            .val(); //
                        var writePerson1 = $(
                            "#writePerson1")
                            .val(); //
                        var qitayongjin1 = $(
                            "#qitayongjin1")
                            .val(); //
                        var shishou1 = $(
                            "#shishou1")
                            .val(); //
                        var syx = $(
                            "#syx")
                            .val(); //
                        var jqx = $(
                            "#jqx")
                            .val(); //

                        var ccs = $(
                            "#ccs")
                            .val(); //
                        var xj = $(
                            "#xj")
                            .val();
                        var gsName = $(
                            "#gsName")
                            .val(); //
                        var allAmount1 = $(
                            "#allAmount1")
                            .val(); //
                        var jsonStr = "{";

                        /*var tabBusinessNature = $("#tabBusinessNature1").val();
                        var tabIsRenewal = $("#tabIsRenewal1").val();
                        var tab_jqfyl = $("#tab_jqfyl").val();
                        var tab_syfyl = $("#tab_syfyl").val();
                        var tab_jqjbf = $("#tab_jqjbf").val();
                        var tab_syjbf = $("#tab_syjbf").val();
                        var tab_jqxfy = $("#tab_jqxfy").val();
                        var tab_syxfy = $("#tab_syxfy").val();
                        var tabIllustrate = $("#tabIllustrate").val();
                        var tabReserve = $("#tabReserve").val();
                        var tabItems = $("#tabItems").val();*/

                        if (yId !== "") {
                            jsonStr = jsonStr + "\"id\":" + yId;
                        }
                        if (tabBusinessNature !== "") {
                            jsonStr = jsonStr + ",\"tabBusinessNature\":" + tabBusinessNature;
                        }
                        if (tabIsRenewal !== "") {
                            jsonStr = jsonStr + ",\"tabIsRenewal\":" + tabIsRenewal;
                        }
                        if (tab_jqfyl !== "") {
                            jsonStr = jsonStr + ",\"tabJqfyl\":" + tab_jqfyl;
                        }
                        if (tab_syfyl !== "") {
                            jsonStr = jsonStr + ",\"tabSyfyl\":" + tab_syfyl;
                        }
                        if (tab_jqjbf !== "") {
                            jsonStr = jsonStr + ",\"tabJqjbf\":" + tab_jqjbf;
                        }
                        if (tab_syjbf !== "") {
                            jsonStr = jsonStr + ",\"tabSyjbf\":" + tab_syjbf;
                        }
                        if (tab_jqxfy !== "") {
                            jsonStr = jsonStr + ",\"tabJqxfy\":" + tab_jqxfy;
                        }
                        if (tab_syxfy !== "") {
                            jsonStr = jsonStr + ",\"tabSyxfy\":" + tab_syxfy;
                        }
                        if (tabIllustrate !== "") {
                            jsonStr = jsonStr + ",\"tabIllustrate\":" + tabIllustrate;
                        }
                        if (tabReserve !== "") {
                            jsonStr = jsonStr + ",\"tabReserve\":" + tabReserve;
                        }
                        if (tabItems !== "") {
                            jsonStr = jsonStr + ",\"tabItems\":" + tabItems;
                        }
                        if (tabCarNum !== "") {
                            jsonStr = jsonStr +
                                ",\"tabCarNum\":" +
                                tabCarNum;
                        }
                        if (payState !== "") {
                            jsonStr = jsonStr +
                                ",\"tabAgentPay\":" +
                                payState;
                        }
                        if (tabAmountSate1 !== "") {
                            jsonStr = jsonStr +
                                ",\"tabAmountSate\":" +
                                tabAmountSate1;
                        }
                        if (tabMessage1 !== "") {
                            jsonStr = jsonStr +
                                ",\"tabMessage\":" +
                                tabMessage1;
                        }
                        if (jfys !== "") {
                            jsonStr = jsonStr +
                                ",\"tabJfysAmount\":" +
                                jfys;
                        }
                        if (tab_ygzhjq_amount1 !== "") {
                            jsonStr = jsonStr +
                                ",\"tabYgzhjqAmount\":" +
                                tab_ygzhjq_amount1;
                        }
                        if (tab_ygzhsy_amount1 !== "") {
                            jsonStr = jsonStr +
                                ",\"tabYgzhsyAmount\":" +
                                tab_ygzhsy_amount1;
                        }
                        if (tab_jbfjql1 !== "") {
                            jsonStr = jsonStr +
                                ",\"tabJbfjql\":" +
                                tab_jbfjql1;
                        }
                        if (tabJbfsyl1 !== "") {
                            jsonStr = jsonStr +
                                ",\"tabJbfsyl\":" +
                                tabJbfsyl1;
                        }
                        if (tab_zbf_j1 !== "") {
                            jsonStr = jsonStr +
                                ",\"tabZbfJ\":" +
                                tab_zbf_j1;
                        }
                        if (tabCustomerMobile1 !== "") {
                            jsonStr = jsonStr +
                                ",\"tabCustomerMobile\":" +
                                tabCustomerMobile1;
                        }
                        if (writePerson1 !== "") {
                            jsonStr = jsonStr +
                                ",\"tabCdPerson\":" +
                                writePerson1;
                            jsonStr = jsonStr +
                                ",\"tabManagerUser\":" +
                                writePerson1;
                        }
                        if (qitayongjin1 !== "") {
                            jsonStr = jsonStr +
                                ",\"tabCommissionOther\":" +
                                qitayongjin1;
                        }
                        if (shishou1 !== "") {
                            jsonStr = jsonStr +
                                ",\"tabRealAmount\":" +
                                shishou1;
                        }
                        if (syx !== "") {
                            jsonStr = jsonStr + ",\"tabCommercialInsurance\":" + syx;
                        }
                        if (jqx !== "") {
                            jsonStr = jsonStr + ",\"tabCompulsoryInsurance\":" + jqx;
                        }
                        if (ccs !== "") {
                            jsonStr = jsonStr + ",\"tabTax\":" + ccs;
                        }
                        if (xj !== "") {
                            jsonStr = jsonStr + ",\"tabCommissionAmount\":" + xj;
                        }
                        if (gsName !== "") {
                            jsonStr = jsonStr + ",\"tabInsuranceCompanyName\":" + gsName;
                        }
                        if (allAmount1 !== "") {
                            jsonStr = jsonStr +
                                ",\"tabAllAmount\":" +
                                allAmount1;
                            jsonStr = jsonStr +
                                ",\"tabSubtotal\":" +
                                allAmount1;
                        }

                        if (tabYxState !== "") {
                            jsonStr = jsonStr +
                                ",\"tabYxState\":" +
                                tabYxState;
                        }
                        if (nature !== "") {
                            jsonStr = jsonStr +
                                ",\"tabCarState\":" +
                                nature;
                        }
                        if (channelName !== "") {
                            jsonStr = jsonStr +
                                ",\"tabChannel\":" +
                                channelName;
                        }
                        if (agentId !== "") {
                            jsonStr = jsonStr +
                                ",\"tabAgentName\":" +
                                agentId;
                        }

                        if (tabStartDate !== "") {
                            jsonStr = jsonStr +
                                ",\"tabStartDate\":\"" +
                                tabStartDate +
                                " \"";
                        }
                        if (tabQdDate !== "") {
                            jsonStr = jsonStr +
                                ",\"tabQdDate\":\"" +
                                tabQdDate +
                                " \"";
                        }
                        if (tabEndDate !== "") {
                            jsonStr = jsonStr +
                                ",\"tabEndDate\":\"" +
                                tabEndDate +
                                " \"";
                        }

                        if (tabSafePerson !== "") {
                            jsonStr = jsonStr +
                                ",\"tabSafePerson\":" +
                                tabSafePerson;
                        }
                        if (teamId !== "") {
                            jsonStr = jsonStr +
                                ",\"tabTeamOwnership\":" +
                                teamId;
                        }
                        /* if(insurerId!=""){
                         jsonStr=jsonStr+",\"tabInsuranceCompanyName\":"+insurerId;
                        } */
                        if (whPersonSelect !== "") {
                            jsonStr = jsonStr + ",\"tabWhPerson\":" + whPersonSelect;
                        }
                        if (jsonStr !== "{") {
                            jsonStr = jsonStr + "}";
                        } else {
                            jsonStr = null;
                        }

                        $.ajax({
                            url: '/yxbx/addTabScheduleOfInsuranceTrue',
                            type: 'POST',
                            data: {
                                'userId': userInfo.userId,
                                'tsoiStrJson': jsonStr
                            },
                            success: function (res) {
                                var data = eval('(' + res + ')');
                                console.log(data);
                                if (data.msg === '权限不足') {
                                    alert('您的权限为' + userInfo.user_type + ',您只能增加比它大的用户权限');
                                } else if (data.code === 0) {
                                    if (fileArr.length > 0) {
                                        var fileIds = "";
                                        for (var i = 0; i < fileArr.length; i++) {
                                            fileIds = fileIds + fileArr[i];
                                            if (i !== fileArr.length - 1) {
                                                fileIds = fileIds + ",";
                                            }
                                        }
                                        var data1 = data.data;
                                        console.log(data1);
                                        $.ajax({
                                            url: '/yxbx/addInsuranceTrueFile',
                                            type: 'POST',
                                            data: {
                                                'businessID': data1,
                                                'fileIds': fileIds
                                            },
                                            success: function (res) {
                                                var data = eval('(' + res + ')');
                                                console.log(data);
                                                //这里以搜索为例
                                                // location.reload();
                                                layer.closeAll();
                                                alert("添加成功!!");
                                                tableIns.reload({
                                                    page: {
                                                        curr: 1 //重新从第 1 页开始
                                                    }
                                                });
                                            },
                                            error: function (res) {
                                                console.log(res);
                                            }
                                        });
                                    } else {
                                        //这里以搜索为例
                                        // location.reload();
                                        layer.closeAll();
                                        alert("添加成功!");
                                        tableIns.reload({
                                            page: {
                                                curr: 1 //重新从第 1 页开始
                                            }
                                        });
                                    }
                                } else {
                                    alert(data.msg);
                                }
                            },
                            error: function (res) {
                                alert("请求失败！");
                                console.log(res);
                            }
                        });
                        console.log('提交');
                    },
                    success: function (layero, index) {
                        // console.log(fileArr);
                        var fileSrc = "";
                        for (var i = 0; i < fileArr.length; i++) {
                            // console.log(fileArr[i]);
                            fileSrc = fileBaseAdress + fileArr[i];
                            // console.log(fileSrc);
                            $('#demo2').append('<div id="" class="file-iteme">' + '<div class="handle" >' + fileArr[i] + '</div>' +
                                '<img class="demo34" onclick="openImg(this)" style="width: 100px;height: 100px;"  src=' +
                                fileSrc + '>' + '<div class="info">' + '点击头部删除' + '</div>' + '</div>');
                        }
                    }
                });
            });
        });
        userInfo = JSON.parse(localStorage.getItem("userInfo"));

        //展示已知数据   表格数据
        var tableIns = table.render({
            elem: '#demo',
            height: 500, //设置高度,
            url: '/yxbx/findInsuranceTrue',
            size: 'sm',
            type: 'POST',
            where: {
                'pageSize': 10,
                'userId': userInfo.userId
            },
            cols: [
                [{
                    type: 'checkbox', fixed: 'left'
                },
                // ---------不匹配
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabQdDate',
                    title: '保批单日期',
                    width: 150
                },
                // 不匹配
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabEndDate',
                    title: '到期日',
                    width: 150
                }, {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabStartDate',
                    title: '出单日期',
                    width: 150,
                    sort: true
                },
                //-------------
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabCarNum',
                    title: '车牌',
                    width: 100
                },
                //-------------word中和excel不匹配----客户
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabSafePerson',
                    title: '被保险人',
                    width: 100
                },
                //-------------
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabBusinessNature',
                    title: '业务性质',
                    width: 100
                },
                // -------是否续保---转续保
                { //新增的表头，是否续保
                    align: 'center',
                    event: 'setSign',
                    field: 'tabIsRenewal',
                    title: '转续保',
                    width: 120
                }, {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabCarState',
                    title: '使用性质',
                    width: 100
                }, {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabChannel',
                    title: '渠道',
                    width: 100
                }, {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabInsuranceCompanyName',
                    title: '保险公司',
                    width: 120
                }, {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabCompulsoryInsurance',
                    title: '交强险',
                    width: 100
                },
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabCommercialInsurance',
                    title: '商业险',
                    width: 100
                }, {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabTax',
                    title: '车船税',
                    width: 100
                }, {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabSubtotal',
                    title: '小计',
                    width: 100
                },
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabAgentName',
                    title: '代理人',
                    width: 100
                },
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabTeamOwnership',
                    title: '团队名称',
                    width: 100
                }, {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabAgentPay',
                    title: '结算方式',
                    width: 120
                },
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabMessage',
                    title: '备注',
                    width: 100
                },
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabManagerUser',
                    title: '出单员',
                    width: 100
                },
                //-------------
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabWhPerson',
                    title: '维护人',
                    width: 100
                },
                //
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabCustomerMobile',
                    title: '客户电话',
                    width: 100
                },
                //-------------
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabJqjbf',
                    title: '交强净保费',
                    width: 100
                },
                //-------------
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabJqfyl',
                    title: '交强费用率',
                    width: 100
                },
                //-------------
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabJqxfy',
                    title: '交强险费用',
                    width: 100
                },
                //-------------
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabSyjbf',
                    title: '商业净保费',
                    width: 100
                },
                //-------------
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabSyfyl',
                    title: '商业费用率',
                    width: 100
                },
                //-------------
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabSyxfy',
                    title: '商业险费用',
                    width: 100
                },
                //------------不匹配
                { //新增的表头，业务编号
                    align: 'center',
                    event: 'setSign',
                    field: 'tabCommissionOther',
                    title: '其他应付',
                    width: 100
                },
                { //新增的表头，业务编号
                    align: 'center',
                    event: 'setSign',
                    field: 'tabCommissionAmount',
                    title: '佣金合计',
                    width: 100
                },
                //-------------
                // {
                //     event: 'setSign',
                //     field: 'tabAmountSate',
                //     title: '保费收款状态',
                //     width: 120
                // },
                //     {
                //     align: 'center',
                //     event: 'setSign',
                //     field: 'tabYxState',
                //     title: '险种',
                //     width: 100
                // },

                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabIsAuditing',
                    title: '打款状态',
                    width: 120
                },
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabPayID',
                    title: '付款编号',
                    width: 120
                },
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabPayDate',
                    title: '打款时间',
                    width: 150,
                    sort: true
                },
                {
                    event: 'setSign',
                    field: 'tabWriteDate',
                    title: '录入日期',
                    width: 150
                },
                {
                    align: 'center',
                    event: 'setSign',
                    field: 'tabCdPerson',
                    title: '录入人',
                    width: 100
                },
                { //新增的表头，业务编号
                    align: 'center',
                    event: 'setSign',
                    field: 'tabBusinessID',
                    title: '业务编号',
                    width: 150
                }
                    // {
                    // 	align: 'center',
                    // 	event: 'setSign',
                    // 	field: 'tabAnnotationsPerson',
                    // 	title: '审核人',
                    // 	width: 120,
                    // 	show: false
                    // }, {
                    // 	align: 'center',
                    // 	event: 'setSign',
                    // 	field: 'tabtype',
                    // 	title: '重复表示',
                    // 	width: 120,
                    // 	show: false
                    // },
                    // , {
                    //     // event: 'setSign',
                    //     fixed: 'right',
                    //     width: 120,
                    //     align: 'center',
                    //     toolbar: '#barDemo'
                    // }
                ]
            ],
            data: [{
                "tabAgentName": "张三一一",
                "tabTeamOwnership": "李四二二",
                "tabSafePerson": "王五三三",
                "tabCarNum": "浙CE9N5E",
                "tabCommercialInsurance": "2001.01",
                "tabCompulsoryInsurance": "990.0",
                "tabTax": "100.0",
                "tabAllAmount": "14217.01",
                "tabStartDate": "2018-02-01",
                "tabCarState": "非运营客车",
                "tabInsuranceCompanyName": "苍南人保",
                "isRenewal": "续保",
                "tabYxState": "车险",
                "tabChannel": "传统",
                "tabAgentPay": "日结",
                "tabZbfJ": "已收全额",
                "tabIsAuditing": "",
                "id": "",
                "tabPayDate": "",
                "tabQdDate": "2016-10-14",
                "tabEndDate": "2016-10-14",
                "tabWriteDate": "2016-10-14",
                "tabCdPerson": "张三一一",
                "tabBusinessID": "1812451690"
            }],
            //skin : 'line',
            //even : true,
            page: true, //是否显示分页
            limit: 20, //每页默认显示的数量
            done: function (res, curr, count) { // 表格渲染完成之后的回调
                $("[data-field='tabtype']").css('display', 'none');
                // $('#demo')
                //     .next()
                //     .find('.layui-table-body')
                //     .find("table")
                //     .find("tbody")
                //     .children("tr")
                //     .on('dblclick',
                //         function () {
                //   双击事件
                // table.on('rowDouble(test1)', function (obj) {
                //     window.alert(obj)
                //     //obj 同上
                // });


                // 监听双击事件
                var that = this.elem.next();
                // var index;
                // var tableData;
                // var trHasClass;
                $('#demo')
                    .next()
                    .find('.layui-table-body')
                    .find("table")
                    .find("tbody")
                    .children("tr")
                    .on('dblclick',
                        function (obj1) {
                            clearTimeout(timer);
                            var id = JSON.stringify($('#demo').next().find('.layui-table-body').find("table").find("tbody").find(
                                ".layui-table-hover").data('index'));
                            var obj = res.data[id];
                            var data = obj.data;
                            var ajaxId = obj.id;
                            // index = obj.tr.data('index')
                            // tableData = table.cache.menu
                            // trHasClass = obj.tr.hasClass
                            // 详情数据
                            console.log(id, obj);
                            console.log(obj.tabCarNum);
                            // 第一层数据
                            $('#detail-1-1').html(obj.tabBusinessID);
                            $('#detail-1-2').html(obj.tabAgentName);
                            $('#detail-1-3').html(obj.tabCarNum);
                            // 第二层数据
                            $('#detail-2-1').html(obj.tabCustomerMobile);
                            $('#detail-2-2').html(obj.tabSafePerson);
                            $('#detail-2-3').html(obj.tabInsuranceCompanyName);
                            // 第三层数据
                            $('#detail-3-1').html(obj.tabChannel);
                            $('#detail-3-2').html(obj.tabCarState);
                            $('#detail-3-3').html(obj.tabBusinessNature);
                            // 第三层数据
                            $('#detail-10-1').html(obj.tabTeamOwnership);
                            $('#detail-10-2').html(obj.tabAgentPay);
                            $('#detail-10-3').html(obj.tabIsRenewal);
                            // 第四层数据
                            $('#detail-4-1').html(obj.tabStartDate);
                            $('#detail-4-2').html(obj.tabQdDate);
                            $('#detail-4-3').html(obj.tabEndDate);
                            // 商业险
                            // 第五层数据
                            $('#detail-5-1').html(obj.tabCommercialInsurance);
                            $('#detail-5-2').html(obj.tabCompulsoryInsurance);
                            $('#detail-5-3').html(obj.tabTax);
                            // 实收
                            // -----------------------第六层数据
                            // $('#shishou1').attr('value',obj.tabRealAmount)
                            $('#detail-6-1').html(obj.tabCommissionOther);
                            // 佣金合计
                            $('#detail-6-2').html(obj.tabCommissionAmount);
                            // 交强净保费
                            $('#detail-6-3').html(obj.tabSubtotal);
                            // ----------------------第七层数据
                            // 商业净保费
                            $('#detail-7-1').html(obj.tabSyjbf);
                            // 结算方式
                            $('#detail-7-2').html(obj.tabSyfyl);
                            $('#detail-7-3').html(obj.tabSyxfy);
                            // --------------------第八层数据
                            $('#detail-8-1').html(obj.tabJqjbf);
                            // 净费应收
                            $('#detail-8-2').html(obj.tabJqfyl);
                            // 保费收款状态
                            $('#detail-8-3').html(obj.tabJqxfy);
                            // -------------------第九层数据
                            $('#detail-9-1').html(obj.tabAmountSate);
                            $('#detail-9-2').html(obj.tabIsCommit);
                            $('#detail-9-3').html(obj.tabCdPerson);
                            //---------------------- 第十层数据
                            $('#detail-11-1').html(obj.tabMessage);
                            $('#detail-11-2').html(obj.tabReserve);
                            $('#detail-11-3').html(obj.tabIllustrate);
                            $('#detail-11-4').html(obj.tabItems);
                            getPhoto(ajaxId);

                            function getPhoto(id) {
                                $.ajax({
                                    url: '/yxbx/queryFile',
                                    type: 'POST',
                                    data: {
                                        'trueSId': id,
                                        'userId': userInfo.userId
                                    },
                                    success: function (res) {
                                        var data = eval('(' +
                                            res + ')');
                                        console.log(data);
                                        if (data.msg === '权限不足') {
                                            alert('您的权限为' + userInfo.user_type + ',您只能增加比它大的用户权限');
                                        } else if (data.code === 0) {
                                            // 编辑图片获取图片数据
                                            var FileList = data.data;
                                            console.log(FileList)
                                            for (var i = 0; i < FileList.length; i++) {

                                                var imgUrl = "http://localhost:8082/yxbx/files/" + FileList[i].tabFileAddress;

                                                $('#demo3').append('<div id="" class="file-iteme">' + '<div class="handle" >' +
                                                    FileList[i].tabFileAddress + '</div>' +
                                                    '<img class="demo34" onclick="openImg(this)" style="width: 100px;height: 100px;"  src=' +
                                                    imgUrl + '>' + '<div class="info">' + '点击头部删除' + '</div>' + '</div>');

                                                /*   if(i==0&&pt==null){
                                                    $(document).ready(function(){
                                                      //jquery方式
                                                     //调用示例
                                                    pt=  layer.photos({
                                                       photos: '#layer-photos-demo'
                                                       ,anim:-1//0-6的选择，指定弹出图片动画类型，默认随机（请注意，3.0之前的版本用shift参数）
                                                      });
                                                    });
                                                   }  */

                                            }

                                            //	layer.close(layer.index);
                                        } else {
                                            alert(data.msg);

                                        }
                                    },
                                    error: function (res) {
                                        console.log(res);
                                    }
                                });

                            }


                            // 双击编辑
                            // adOnclick(obj);
                            layui.use('layer',
                                function () {
                                    var $ = layui.jquery,
                                        layer = layui.layer;

                                    layer.open({
                                        type: 1,
                                        id: obj.id,
                                        title: [
                                            '详情',
                                            'font-size:18px;'
                                        ],
                                        end: function () {
                                            $("#showDetail").hide();
                                            $('.demo34').parent().remove();
                                            $('.info').parent().remove();
                                        },
                                        btn: [
                                            '提交',
                                            '关闭'
                                        ],
                                        yes: function (index, layero) {
                                            //  var jsonStr="{"id":102,"tabCarNum":"浙CEJ688","tabSafePerson":"彭成帮","tabYxState":"超级帅气","tabCarState":"客车","tabChannel":"平阳永顺","tabInsuranceCompanyName":"龙港太保","tabCdPerson":"吴玉修","tabWhPerson":"李学聪","tabAgentName":"杨思伟杨宗波","tabAmountSate":"已收","tabTeamOwnership":"杨思伟"}";
                                            var channelName = $("#tabChannel1").val();
                                            var tabAmountSate = $("#tabAmountSate1").val();
                                            var nature = $(
                                                "#tabCarState1")
                                                .val();
                                            //  var quality  = $("#qualitySelect").find("option:selected").text();
                                            // var insurerId =$('#insuranceSelect option:selected') .val();
                                            //var insurerId = $("#insuranceSelect").find("option:selected").text();
                                            var agentId = $(
                                                "#tabAgentName1")
                                                .val();
                                            var teamId = $(
                                                "#teamsSelect1")
                                                .val();
                                            var whPersonSelect = $("#whPersonSelect").find("option:selected").text();
                                            userInfo = JSON
                                                .parse(localStorage
                                                    .getItem("userInfo"));
                                            var tabSafePerson = $(
                                                "#sPerson")
                                                .val(); //客户
                                            var yId = $(
                                                "#yId")
                                                .val(); //业务编码
                                            var tabCarNum = $(
                                                "#tabCarNum1")
                                                .val(); //车牌
                                            var tabYxState = $(
                                                "#tabYxState1")
                                                .val(); //险种
                                            var tabStartDate = $(
                                                "#test91")
                                                .val(); //出单日期
                                            var tabQdDate = $(
                                                "#test101")
                                                .val(); //生效时间结束
                                            var tabEndDate = $(
                                                "#test111")
                                                .val(); //失效时间结束
                                            var payState = $(
                                                "#payState")
                                                .val(); //付款方式
                                            var tabAmountSate1 = $(
                                                "#tabAmountSate1")
                                                .val(); //收款状态
                                            var tabMessage1 = $(
                                                "#tabMessage1")
                                                .val(); //备注
                                            var jfys = $(
                                                "#jfys")
                                                .val(); //
                                            var tab_ygzhjq_amount1 = $(
                                                "#tab_ygzhjq_amount1")
                                                .val(); //
                                            var tab_ygzhsy_amount1 = $(
                                                "#tab_ygzhsy_amount1")
                                                .val(); //
                                            var tab_jbfjql1 = $(
                                                "#tab_jbfjql1")
                                                .val(); //
                                            var tabJbfsyl1 = $(
                                                "#tabJbfsyl1")
                                                .val(); //
                                            var tab_zbf_j1 = $(
                                                "#tab_zbf_j1")
                                                .val(); //
                                            var tabCustomerMobile1 = $(
                                                "#tabCustomerMobile1")
                                                .val(); //
                                            var writePerson1 = $(
                                                "#writePerson1")
                                                .val(); //
                                            var qitayongjin1 = $(
                                                "#qitayongjin1")
                                                .val(); //
                                            var shishou1 = $(
                                                "#shishou1")
                                                .val(); //
                                            var syx = $(
                                                "#syx")
                                                .val(); //
                                            var jqx = $(
                                                "#jqx")
                                                .val(); //

                                            var ccs = $(
                                                "#ccs")
                                                .val(); //
                                            var xj = $(
                                                "#xj")
                                                .val();
                                            var gsName = $(
                                                "#gsName")
                                                .val(); //
                                            var allAmount1 = $(
                                                "#allAmount1")
                                                .val(); //
                                            var jsonStr = "{";
                                            if (yId !== "") {
                                                jsonStr = jsonStr +
                                                    "\"id\":" +
                                                    yId;
                                            }
                                            if (tabCarNum !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabCarNum\":" +
                                                    tabCarNum;
                                            }
                                            if (payState !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabCardState\":" +
                                                    payState;
                                            }
                                            if (tabAmountSate1 !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabAmountSate\":" +
                                                    tabAmountSate1;
                                            }
                                            if (tabMessage1 !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabMessage\":" +
                                                    tabMessage1;
                                            }
                                            if (jfys !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabJfysAmount\":" +
                                                    jfys;
                                            }
                                            if (tab_ygzhjq_amount1 !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabYgzhjqAmount\":" +
                                                    tab_ygzhjq_amount1;
                                            }
                                            if (tab_ygzhsy_amount1 !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabYgzhsyAmount\":" +
                                                    tab_ygzhsy_amount1;
                                            }
                                            if (tab_jbfjql1 !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabJbfjql\":" +
                                                    tab_jbfjql1;
                                            }
                                            if (tabJbfsyl1 !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabJbfsyl\":" +
                                                    tabJbfsyl1;
                                            }
                                            if (tab_zbf_j1 !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabZbfJ\":" +
                                                    tab_zbf_j1;
                                            }
                                            if (tabCustomerMobile1 !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabCustomerMobile\":" +
                                                    tabCustomerMobile1;
                                            }
                                            if (writePerson1 !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabManagerUser\":" +
                                                    writePerson1;
                                            }
                                            if (qitayongjin1 !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabCommissionOther\":" +
                                                    qitayongjin1;
                                            }
                                            if (shishou1 !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabRealAmount\":" +
                                                    shishou1;
                                            }
                                            if (syx !== "") {
                                                jsonStr = jsonStr + ",\"tabCommercialInsurance\":" + syx;
                                            }
                                            if (jqx !== "") {
                                                jsonStr = jsonStr + ",\"tabCompulsoryInsurance\":" + jqx;
                                            }
                                            if (ccs !== "") {
                                                jsonStr = jsonStr + ",\"tabTax\":" + ccs;
                                            }
                                            if (xj !== "") {
                                                jsonStr = jsonStr + ",\"tabCommissionAmount\":" + xj;
                                            }
                                            if (gsName !== "") {
                                                jsonStr = jsonStr + ",\"tabInsuranceCompanyName\":" + gsName;
                                            }
                                            if (allAmount1 !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabAllAmount\":" +
                                                    allAmount1;
                                            }

                                            if (tabYxState !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabYxState\":" +
                                                    tabYxState;
                                            }
                                            if (nature !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabCarState\":" +
                                                    nature;
                                            }
                                            if (channelName !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabChannel\":" +
                                                    channelName;
                                            }
                                            if (agentId !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabAgentName\":" +
                                                    agentId;
                                            }

                                            if (tabStartDate !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabStartDate\":\"" +
                                                    tabStartDate +
                                                    " \"";
                                            }
                                            if (tabQdDate !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabQdDate\":\"" +
                                                    tabQdDate +
                                                    " \"";
                                            }
                                            if (tabEndDate !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabEndDate\":\"" +
                                                    tabEndDate +
                                                    " \"";
                                            }

                                            if (tabSafePerson !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabSafePerson\":" +
                                                    tabSafePerson;
                                            }
                                            if (teamId !== "") {
                                                jsonStr = jsonStr +
                                                    ",\"tabTeamOwnership\":" +
                                                    teamId;
                                            }
                                            if (whPersonSelect !== "") {
                                                jsonStr = jsonStr + ",\"tabWhPerson\":" + whPersonSelect;
                                            }
                                            if (jsonStr !== "{") {

                                                jsonStr = jsonStr +
                                                    "}";
                                            } else {
                                                jsonStr = null;
                                            }
                                            console.log('提交');
                                        },
                                        content: $('#showDetail'),
                                        skin: 'layui-layer-rim',
                                        area: [
                                            '100%',
                                            '98%'
                                        ],
                                        shadeClose: true, //开启遮罩关闭
                                        resize: false
                                    });

                                }
                            );


                        });


                userInfo = JSON.parse(localStorage.getItem("userInfo"));

                //监听行单击事件
                // table.on('row(test1)', function (obj) {
                //     console.log(obj)
                //     //动态添加背景色
                //     if (obj.tr.hasClass('layui-table-click')) {
                //         obj.tr.removeClass('layui-table-click');
                //     } else {
                //         obj.tr.addClass('layui-table-click');
                //     }

                //     var index = obj.tr.data('index');
                //     var tableData = table.cache.menu;//menu 是表格id
                //     var trHasClass = obj.tr.hasClass('layui-table-click');

                //     //循环判断class,选中checkbox
                //     layui.each(tableData, function (i, item) {
                //         if (trHasClass == true) {
                //             obj.tr.addClass('layui-table-click')
                //         } else {
                //             obj.tr.removeClass('layui-table-click')
                //         }
                //     });
                //     // layui.stope(obj)
                //     // 冒泡
                //     // obj.stopPropagation()
                //     // window.event.cancelBubble = true;

                // });



                // 实现选中表格行选中复选框


                res.data.forEach(function (item, index) {
                    //console.log(item.empName);item表示每列显示的数据
                    if (res.data[index].againState === 1) {
                        var tr = that
                            .find(".layui-table-box tbody tr[data-index='" + index + "']")
                            .css({
                                "color": "#fd0000",
                                "fontWeight": "bold"
                            });
                    } else if (res.data[index].againState === 2) {
                        var tr = that
                            .find(".layui-table-box tbody tr[data-index='" + index + "']")
                            .css({
                                "color": "#fd0000",
                                "fontWeight": "bold"
                            });
                    } else if (res.data[index].againState === 3) {
                        var tr = that
                            .find(".layui-table-box tbody tr[data-index='" + index + "']")
                            .css({
                                "color": "#fd0000",
                                "fontWeight": "bold"
                            });
                    } else if (res.data[index].againState === 4) {
                        var tr = that
                            .find(".layui-table-box tbody tr[data-index='" + index + "']")
                            .css({
                                "color": "#fd0000",
                                "fontWeight": "bold"
                            });
                    } else if (res.data[index].againState === 5) {
                        var tr = that
                            .find(
                                ".layui-table-box tbody tr[data-index='" +
                                index +
                                "']")
                            .css({
                                "color": "#fd0000",
                                "fontWeight": "bold"
                            });
                    } else if (res.data[index].againState === 6) {
                        var tr = that
                            .find(".layui-table-box tbody tr[data-index='" + index + "']")
                            .css({
                                "color": "#fd0000",
                                "fontWeight": "bold"
                            });
                    } else if (res.data[index].againState !== 0) {
                        var tr = that
                            .find(".layui-table-box tbody tr[data-index='" + index + "']")
                            .css({
                                "color": "#fd0000",
                                "fontWeight": "bold"
                            });
                    }
                });

            }
        });
        //单击行勾选checkbox事件
        $(document).on("click", ".layui-table-body table.layui-table tbody tr", function () {
            var index = $(this).attr('data-index');
            var tableBox = $(this).parents('.layui-table-box');
            //存在固定列
            if (tableBox.find(".layui-table-fixed.layui-table-fixed-l").length > 0) {
                tableDiv = tableBox.find(".layui-table-fixed.layui-table-fixed-l");
            } else {
                tableDiv = tableBox.find(".layui-table-body.layui-table-main");
            }
            var checkCell = tableDiv.find("tr[data-index=" + index + "]").find("td div.laytable-cell-checkbox div.layui-form-checkbox I");
            if (checkCell.length > 0) {
                checkCell.click();
            }
        });
        var checkitems = [];//选中的行的数据
        var checkitemIds = [];//选中的行的id
        //监听复选框点击事件
        table.on('checkbox(test1)', function (obj) {
            // 全选
            console.log(obj.checked); //当前是否选中状态
            console.log(obj.data); //选中行的相关数据

            if (obj.type == 'all' && obj.checked == true) {

                $('.layui-table-body table.layui-table tbody tr').addClass('table-checked-bg')
                console.log("全选选中");
                for (var j = 0; j < checkStatus.data.length; j++) {
                    // console.log(checkitemIds.indexOf(checkStatus.data[j].id));
                    if (checkitemIds.indexOf(checkStatus.data[j].id) === -1) {
                        checkitems[checkitems.length] = checkStatus.data[j];
                        checkitemIds[checkitemIds.length] = checkStatus.data[j].id;
                    }
                }
            } else if (obj.checked == false && obj.type == 'all') {
                // 取消全选
                $('.layui-table-body table.layui-table tbody tr').removeClass('layui-table-click');
                console.log("全选取消");
                checkitems.length = 0;
                checkitemIds.length = 0;
                $('.layui-table-body table.layui-table tbody tr').removeClass('table-checked-bg')
            } else if (obj.checked == true && obj.type == 'one') {
                //点击单行
                if (obj.checked == true) {
                    obj.tr.addClass('table-checked-bg');
                    console.log("单选选中");
                    checkitems[checkitems.length] = obj.data;
                    checkitemIds[checkitemIds.length] = obj.data.id;
                    var checkStatus = table.checkStatus('test1')
                        , data = checkStatus.data;
                } else {
                    obj.tr.removeClass('table-checked-bg');
                }
            } else if (obj.checked == false && obj.type == 'one') {
                //点击全选之后点击单行
                for (var j = 0; j < checkitems.length; j++) {
                    if (checkitems[j].id === obj.data.id) {
                        checkitems.splice(j, 1);
                        checkitemIds.splice(j, 1);
                    }
                }
                if (obj.tr.hasClass('table-checked-bg')) {
                    obj.tr.removeClass('table-checked-bg');
                    obj.tr.removeClass('layui-table-click');
                    var checkStatus = table.checkStatus('test1')
                        , data = checkStatus.data;
                }
            }
        });
        $(document).on("click", "td div.laytable-cell-checkbox div.layui-form-checkbox", function (e) {
            e.stopPropagation();
        });
        //制定时间点击弹出日历
        layui.use('laydate', function () {
            var laydate = layui.laydate;

            //执行一个laydate实例
            laydate.render({
                elem: '#test1' //指定元素

            });
            //执行一个laydate实例
            laydate.render({
                elem: '#test2' //指定元素
            });
            //执行一个laydate实例
            laydate.render({
                elem: '#test3' //指定元素
            });
            //执行一个laydate实例
            laydate.render({
                elem: '#test4' //指定元素
            });
            //执行一个laydate实例
            laydate.render({
                elem: '#test5' //指定元素
            });
            //执行一个laydate实例
            laydate.render({
                elem: '#test6' //指定元素
            });
            //执行一个laydate实例
            laydate.render({
                elem: '#test7' //指定元素
            });
            //执行一个laydate实例
            laydate.render({
                elem: '#test8' //指定元素
            });
            //执行一个laydate实例
            laydate.render({
                elem: '#test91', //指定元素
                format: 'yyyy-MM-dd HH:mm:ss',
                type: 'datetime'
            });
            //执行一个laydate实例
            laydate.render({
                elem: '#test101', //指定元素
                format: 'yyyy-MM-dd HH:mm:ss',
                type: 'datetime'
            });
            //执行一个laydate实例
            laydate.render({
                elem: '#test111', //指定元素
                format: 'yyyy-MM-dd HH:mm:ss',
                type: 'datetime'
            });
            /* //执行一个laydate实例
            laydate.render({
                format: 'yyyy-MM-dd HH:mm:ss',
                type: 'datetime',
                elem: '#test9' //指定元素
            }); */
            //执行一个laydate实例
            // laydate.render({
            //     format: 'yyyy-MM-dd HH:mm:ss',
            //     type: 'datetime',
            //     elem: '#test10' //指定元素
            // });
            //执行一个laydate实例
            // laydate.render({
            //     format: 'yyyy-MM-dd HH:mm:ss',
            //     type: 'datetime',
            //     elem: '#test11' //指定元素
            // });
        });
        /* 	$(function(){
        var start = {
        elem: '#start', //选择ID为START的input
        format: 'YYYY/MM/DD hh:mm:ss', //自动生成的时间格式
        min: laydate.now(), //设定最小日期为当前日期
        max: '2099-06-16 23:59:59', //最大日期
        istime: true, //必须填入时间
        istoday: false,  //是否是当天
        start: laydate.now(0,"YYYY/MM/DD hh:mm:ss"),  //设置开始时间为当前时间
        choose: function(datas){
             end.min = datas; //开始日选好后，重置结束日的最小日期
             end.start = datas //将结束日的初始值设定为开始日
        }
        };  */

        i = 1;
        var fileArr = [];
        layui.use('upload',
            function () {
                var upload = layui.upload;
                userInfo = JSON.parse(localStorage.getItem("userInfo"));
                //执行实例
                var uploadInst = upload.render({
                    elem: '#testUp',
                    url: '/yxbx/uploadfile',
                    multiple: true, //多文件上传
                    number: 100,
                    /*   auto: false                                 //自动上传,默认是打开的
                     , bindAction: '#btnUpload'                    //auto为false时，点击触发上传
                     , multiple: true                             //多文件上传
                     , number: 100 ,                              //multiple:true时有效 */
                    before: function (obj) {
                        this.data = {
                            "trueSId": $("#hidden_trainSchemeId").val(),
                            "userId": userInfo.userId
                        }; //携带额外的数据
                        layer.msg('图片上传中...', {
                            icon: 16,
                            shade: 0.01,
                            time: 0
                        });

                        /*  //预读本地文件示例，不支持ie8
                           obj.preview(function(index, file, result){
                            $('#demo2').append('<img src="'+ result +'" alt="'+ file.name +'" class="layui-upload-img">');
                           }); */
                    },
                    /*    data: {
                           'userId':userInfo.userId,
                           'trueSId':118

                       }, */
                    done: function (res) {
                        layer.close(layer.index);
                        if (res.code === 1 || res.code === 2) {
                            alert(res.msg);
                            return;
                        }
                        var imgUrl = fileBaseAdress + res.data.src;
                        var fileSrc = "";
                        // alert(res.code);
                        if (res.code === 3) {
                            fileArr[fileArr.length] = res.data.src;
                            //上传完毕回调
                            // console.log(fileArr);
                            // for (var j = 0; j < fileArr.length; j++) {
                            fileSrc = fileBaseAdress + fileArr[fileArr.length - 1];
                            // alert(fileSrc);
                            $('#demo2').append(
                                '<div id="" class="file-iteme">' +
                                '<div class="handle">' +
                                fileArr[fileArr.length - 1] +
                                '</div>' +
                                '<img class="demo34" onclick="openImg(this)" style="width: 100px;height: 100px;"  src=' + fileSrc + '>' +
                                '<div class="info">' +
                                '点击头部删除' +
                                '</div>' +
                                '</div>');
                            // }
                        } else if (res.code === 0) {
                            //上传完毕回调
                            $('#demo2').append(
                                '<div id="" class="file-iteme">' +
                                '<div class="handle">' +
                                res.data.src +
                                '</div>' +
                                '<img class="demo34" onclick="openImg(this)" style="width: 100px;height: 100px;"  src=' + imgUrl + '>' +
                                '<div class="info">' +
                                '点击头部删除' +
                                '</div>' +
                                '</div>');
                        }
                    },
                    error: function () {
                        //请求异常回调
                        alert("请求失败！");
                    }
                });
            });

        layui.use('upload', function () {
            var upload = layui.upload;
            userInfo = JSON.parse(localStorage.getItem("userInfo"));
            //执行实例
            var uploadInst = upload.render({
                elem: '#testUp1',
                url: '/yxbx/uploadMsg_read',
                /*   auto: false                                 //自动上传,默认是打开的
                 , bindAction: '#btnUpload'                    //auto为false时，点击触发上传
                 , multiple: true                             //多文件上传
                 , number: 100 ,                              //multiple:true时有效 */
                accept: 'file',
                before: function (obj) {
                    layer.msg('导入中...', {
                        icon: 16,
                        shade: 0.01,
                        time: 0
                    });

                    /*  //预读本地文件示例，不支持ie8
                       obj.preview(function(index, file, result){
                        $('#demo2').append('<img src="'+ result +'" alt="'+ file.name +'" class="layui-upload-img">');
                       }); */
                },
                data: {
                    'userId': userInfo.userId,
                    'trueSId': 118
                },
                done: function (res) {
                    layer.close(layer.index);
                    if (res.code !== 0) {
                        alert(res.msg);
                    } else {
                        alert(res.msg);
                        location.reload();
                        //这里以搜索为例
                        /*  tableIns.reload({
                             where: { //设定异步数据接口的额外参数，任意设
                                  aaaaaa: 'xxx'
                                  ,bbb: 'yyy'
                                   //…
                            },
                            page: {
                                 curr: 1 //重新从第 1 页开始
                                 }
                          }); */
                    }
                    res = res.data;
                },
                error: function () {
                    //请求异常回调
                    alert("请求失败！");
                }
            });
        });

        // 批量导入确认事件
        function getSure() {
            console.log('hahah');
            document.getElementById('light').style.display = 'none';
            window.location.reload();
            console.log('我已经刷新咯')

        }

        //弹出导出的div
        function openExportDiv() {
            // $("#waitDiv").show();
            layer.confirm('您是想导出勾选数据，还是想导出所有的数据呢？', {
                btn: ['所有的', '勾选的', '关闭 '] //可以无限个按钮
                , btn3: function (index, layero) {
                    exportCSV(3)
                    //按钮【按钮三】的回调
                }
            }, function (index, layero) {
                console.log(1111);
                exportCSV(0)
                //按钮【按钮一】的回调
            }, function (index) {
                //按钮【按钮二】的回调
                exportCSV(1)

            });

        }

        //导出CSV，即导出excel
        function exportCSV(item) {
            console.log('我进来了')
            if (item === 0) {
                $("#exportTips").show();
                $.ajax({
                    url: '/yxbx/exportCSV',
                    type: 'POST',
                    data: {
                        'userId': userInfo.userId
                    },
                    success: function (res) {
                        var data = eval('(' + res + ')');
                        // console.log(data);
                        // alert(data.data);
                        window.location = "http://localhost:8082/yxbx/files/excel/" + data.data;
                        $("#exportTips").hide();
                        $("#waitDiv").hide();
                    },
                    error: function (res) {
                        console.log(res);
                        alert("请求失败！");
                    }
                });
            } else if (item === 1) {
                if (checkitemIds.length === 0) {
                    alert("请勾选清单前的复选框再操作！");
                    return;
                }
                var idStr = "";
                for (var j = 0; j < checkitemIds.length; j++) {
                    idStr = idStr + checkitemIds[j];
                    if (j !== checkitemIds.length - 1) {
                        idStr = idStr + ",";
                    }
                }
                $("#exportTips").show();
                $.ajax({
                    url: '/yxbx/exportCSV',
                    type: 'POST',
                    data: {
                        'userId': userInfo.userId,
                        'idStr': idStr
                    },
                    success: function (res) {
                        var data = eval('(' + res + ')');
                        // console.log(data);
                        // alert(data.data);
                        window.location = "http://localhost:8082/yxbx/files/excel/" + data.data;
                        $("#exportTips").hide();
                        $("#waitDiv").hide();
                    },
                    error: function (res) {
                        alert("请求失败！");
                        console.log(res);
                    }
                });
            } else {
                $("#waitDiv").hide();
            }

        }

        /**
         * 全选
         */
        function selectAll() {
            // $('.layui-form-checked').click();
            $('.layui-unselect').click();

            var checkStatus = table.checkStatus('demo'); //idTest 即为基础参数 id 对应的值

            console.log(checkStatus.data); //获取选中行的数据
            console.log(checkStatus.data.length); //获取选中行数量，可作为是否有选中行的条件
            console.log(checkStatus.isAll); //表格是否全选

            if (checkStatus.isAll) {
                console.log("全选选中");
                for (var j = 0; j < checkStatus.data.length; j++) {
                    // console.log(checkitemIds.indexOf(checkStatus.data[j].id));
                    if (checkitemIds.indexOf(checkStatus.data[j].id) === -1) {
                        checkitems[checkitems.length] = checkStatus.data[j];
                        checkitemIds[checkitemIds.length] = checkStatus.data[j].id;
                    }
                }
            } else {
                console.log("全选取消");
                checkitems.length = 0;
                checkitemIds.length = 0;
            }
        }

        // var checkitems = [];//选中的行的数据
        // var checkitemIds = [];//选中的行的id

        // table.on('checkbox(test1)', function (obj) {
        //     console.log(obj.checked); //当前是否选中状态
        //     console.log(obj.data); //选中行的相关数据
        //     // console.log(obj.type); //如果触发的是全选，则为：all，如果触发的是单选，则为：one
        //     if (obj.type === "all") {
        //         var checkStatus = table.checkStatus('demo'); //idTest 即为基础参数 id 对应的值

        //         console.log(checkStatus.data); //获取选中行的数据
        //         console.log(checkStatus.data.length); //获取选中行数量，可作为是否有选中行的条件
        //         console.log(checkStatus.isAll); //表格是否全选

        //         if (obj.checked) {
        //             $('.layui-table-body table.layui-table tbody tr').addClass('layui-table-click');
        //             console.log("全选选中");
        //             for (var j = 0; j < checkStatus.data.length; j++) {
        //                 // console.log(checkitemIds.indexOf(checkStatus.data[j].id));
        //                 if (checkitemIds.indexOf(checkStatus.data[j].id) === -1) {
        //                     checkitems[checkitems.length] = checkStatus.data[j];
        //                     checkitemIds[checkitemIds.length] = checkStatus.data[j].id;
        //                 }
        //             }
        //         } else {
        //             $('.layui-table-body table.layui-table tbody tr').removeClass('layui-table-click');
        //             console.log("全选取消");
        //             checkitems.length = 0;
        //             checkitemIds.length = 0;
        //         }
        //     } else {
        //         if (obj.checked) {
        //             // obj.tr.addClass('layui-table-click');
        //             console.log("单选选中");
        //             checkitems[checkitems.length] = obj.data;
        //             checkitemIds[checkitemIds.length] = obj.data.id;
        //         } else {
        //             // obj.tr.removeClass('layui-table-click');
        //             console.log("单选取消");
        //             for (var j = 0; j < checkitems.length; j++) {
        //                 if (checkitems[j].id === obj.data.id) {
        //                     checkitems.splice(j, 1);
        //                     checkitemIds.splice(j, 1);
        //                 }
        //             }
        //         }
        //     }
        //     console.log(checkitems);
        //     console.log(checkitemIds);
        // });




        //选中复选框后，点击表格上方的删除按钮
        function deleteItem() {
            if (checkitemIds.length === 0) {
                alert("请勾选保险清单前面的复选框，再进行删除操作！");
                return;
            }
            //向服务端发送删除指令
            userInfo = JSON.parse(localStorage.getItem("userInfo"));
            layer.confirm('是否删除' + checkitemIds.length + '行数据？',
                function (index) {
                    var filds = "";
                    for (var j = 0; j < checkitemIds.length; j++) {
                        filds = filds + checkitemIds[j];
                        if (j !== checkitemIds.length - 1) {
                            filds = filds + ",";
                        }
                    }

                    $.ajax({
                        url: '/yxbx/deleteInsuranceToUser',
                        type: 'POST',
                        data: {
                            'fiId': filds,
                            'userId': userInfo.userId
                        },
                        success: function (res) {
                            var data = eval('(' + res + ')');
                            console.log(data);
                            if (data.msg === '权限不足') {
                                alert('您的权限为' + userInfo.user_type + ',您只能增加比它大的用户权限');
                            } else if (data.code === 0) {
                                alert(data.msg);
                                //这里以搜索为例
                                tableIns.reload({
                                    /*    where: { //设定异步数据接口的额外参数，任意设
                                             aaaaaa: 'xxx'
                                             ,bbb: 'yyy'
                                              //…
                                       }, */
                                    page: {
                                        curr: 1
                                        //重新从第 1 页开始
                                    }
                                });
                                layer.close(layer.index);
                            } else {
                                alert(data.msg);
                            }
                        },
                        error: function (res) {
                            alert("请求失败！");
                            console.log(res);
                        }
                    });
                }
            );
        }

        //选中复选框后，点击表格上方的编辑按钮
        function editItem() {
            if (checkitemIds.length === 0) {
                alert("请勾选保险清单前面的复选框，再进行编辑操作！");
                return;
            }
            if (checkitems.length === 1) {
                $.ajax({
                    url: '/yxbx/queryFile',
                    type: 'POST',
                    data: {
                        'trueSId': checkitems[0].id,
                        'userId': userInfo.userId
                    },
                    success: function (res) {
                        var data = eval('(' + res + ')');
                        console.log(data);
                        if (data.msg === '权限不足') {
                            alert('您的权限为' + userInfo.user_type + ',您只能增加比它大的用户权限');
                        } else if (data.code === 0) {
                            var FileList = data.data;
                            for (var i = 0; i < FileList.length; i++) {

                                var imgUrl = fileBaseAdress + FileList[i].tabFileAddress;

                                $('#demo2').append('<div id="" class="file-iteme">' + '<div class="handle" >' + FileList[i]
                                    .tabFileAddress + '</div>' +
                                    '<img class="demo34" onclick="openImg(this)" style="width: 100px;height: 100px;"  src=' +
                                    imgUrl + '>' + '<div class="info">' + '点击头部删除' + '</div>' + '</div>');
                            }
                        } else {
                            alert(data.msg);
                        }
                    },
                    error: function (res) {
                        alert("请求失败！");
                        console.log(res);
                    }
                });

                console.log(checkitems[0]);

                $("#hidden_trainSchemeId").attr("value", checkitems[0].id);

                $("#pistId").attr("value", checkitems[0].id);
                $("#tabBusinessID1").attr("value", checkitems[0].tabBusinessID);
                $("#tabCarNum1").attr("value", checkitems[0].tabCarNum);
                $("#tabAgentName1").attr("value", checkitems[0].tabAgentName);
                $("#tabCustomerMobile1").attr("value", checkitems[0].tabCustomerMobile);
                $("#sPerson").attr("value", checkitems[0].tabSafePerson);
                $("#tabCarState1").attr("value", checkitems[0].tabCarState);
                //  $("#tabCustomerMobile1").attr("value",data.tabCustomerMobile);

                $("#test91").attr("value", checkitems[0].tabStartDate);
                $("#test101").attr("value", checkitems[0].tabQdDate);
                $("#test111").attr("value",
                    checkitems[0].tabEndDate);
                $("#teamsSelect1").attr("value",
                    checkitems[0].tabTeamOwnership);
                $("#tabChannel1").attr("value",
                    checkitems[0].tabChannel);
                $("#tabYxState1").attr("value",
                    checkitems[0].tabYxState);
                //  $("#hdzzl").attr("value",data.tabChannel);
                $("#payState").attr("value",
                    checkitems[0].tabCardState);
                $("#tabAmountSate1").attr("value",
                    checkitems[0].tabAmountSate);
                $("#tabMessage1").html(checkitems[0].tabMessage);
                $("#jfys").attr("value",
                    checkitems[0].tabJfysAmount);
                $("#tab_ygzhjq_amount1").attr("value",
                    checkitems[0].tabYgzhjqAmount);
                $("#tab_ygzhsy_amount1").attr("value",
                    checkitems[0].tabYgzhsyAmount);
                $("#tab_jbfjql1").attr("value",
                    checkitems[0].tabJbfjql);
                $("#tabJbfsyl1").attr("value",
                    checkitems[0].tabJbfsyl);
                $("#tab_zbf_j1").attr("value",
                    checkitems[0].tabZbfJ);
                $("#writePerson1").attr("value",
                    checkitems[0].tabCdPerson);
                $("#qitayongjin1").attr("value",
                    checkitems[0].tabCommissionOther);
                $("#shishou1").attr("value",
                    checkitems[0].tabRealAmount);
                $("#syx").attr("value",
                    checkitems[0].tabCommercialInsurance);

                $("#jqx").attr("value", checkitems[0].tabCompulsoryInsurance);
                $("#ccs").attr("value", checkitems[0].tabTax);
                /*  $("#ifxbSelect").attr("value",checkitems[0].tab_tax); */
                /*  $("#ifxbSelect").attr("value",checkitems[0].tabTax); */
                $("#xj").attr("value", checkitems[0].tabCommissionAmount);
                $("#gsName").attr("value", checkitems[0].tabInsuranceCompanyName);
                $("#allAmount1").attr("value", checkitems[0].tabAllAmount);

                $("#tabBusinessNature1").attr("value", checkitems[0].tabBusinessNature);
                $("#tabIsRenewal1").attr("value", checkitems[0].tabIsRenewal);
                $("#tab_jqfyl").attr("value", checkitems[0].tabJqfyl);
                $("#tab_syfyl").attr("value", checkitems[0].tabSyfyl);
                $("#tab_jqjbf").attr("value", checkitems[0].tabJqjbf);
                $("#tab_syjbf").attr("value", checkitems[0].tabSyjbf);
                $("#tab_jqxfy").attr("value", checkitems[0].tabJqxfy);
                $("#tab_syxfy").attr("value", checkitems[0].tabSyxfy);
                $("#tabIllustrate").attr("value", checkitems[0].tabIllustrate);
                $("#tabReserve").attr("value", checkitems[0].tabReserve);
                $("#tabItems").attr("value", checkitems[0].tabItems);

                //上传

                //弹出层
                layui.use('layer',
                    function () {
                        var $ = layui.jquery,
                            layer = layui.layer;

                        layer.open({
                            type: 1,
                            id: checkitems[0].id,
                            title: [
                                '编辑',
                                'font-size:18px;'
                            ],
                            end: function () {
                                $("#prompt").hide();
                                $('.demo34').parent().remove();
                                $('.info').parent().remove();

                                $("#hidden_trainSchemeId").attr("value", "");
                                $("#pistId").attr("value", "");
                                $("#tabBusinessID1").attr("value", "");
                                $("#tabCarNum1").attr("value", "");
                                $("#tabAgentName1").attr("value", "");
                                $("#tabCustomerMobile1").attr("value", "");
                                $("#sPerson").attr("value", "");
                                $("#tabCarState1").attr("value", "");
                                //  $("#tabCustomerMobile1").attr("value", "");
                                $("#test91").attr("value", "");
                                $("#test101").attr("value", "");
                                $("#test111").attr("value", "");
                                $("#teamsSelect1").attr("value", "");
                                $("#tabChannel1").attr("value", "");
                                $("#tabYxState1").attr("value", "");
                                //  $("#hdzzl").attr("value", "");
                                $("#payState").attr("value", "");
                                $("#tabAmountSate1").attr("value", "");
                                $("#tabMessage1").html("");
                                $("#jfys").attr("value", "");
                                $("#tab_ygzhjq_amount1").attr("value", "");
                                $("#tab_ygzhsy_amount1").attr("value", "");
                                $("#tab_jbfjql1").attr("value", "");
                                $("#tabJbfsyl1").attr("value", "");
                                $("#tab_zbf_j1").attr("value", "");
                                $("#writePerson1").attr("value", "");
                                $("#qitayongjin1").attr("value", "");
                                $("#shishou1").attr("value", "");
                                $("#syx").attr("value", "");
                                $("#jqx").attr("value", "");
                                $("#ccs").attr("value", "");
                                /*  $("#ifxbSelect").attr("value", ""); */
                                /*  $("#ifxbSelect").attr("value", ""); */
                                $("#xj").attr("value", "");
                                $("#gsName").attr("value", "");
                                $("#allAmount1").attr("value", "");

                                $("#tabBusinessNature1").attr("value", "");
                                $("#tabIsRenewal1").attr("value", "");
                                $("#tab_jqfyl").attr("value", "");
                                $("#tab_syfyl").attr("value", "");
                                $("#tab_jqjbf").attr("value", "");
                                $("#tab_syjbf").attr("value", "");
                                $("#tab_jqxfy").attr("value", "");
                                $("#tab_syxfy").attr("value", "");
                                $("#tabIllustrate").attr("value", "");
                                $("#tabReserve").attr("value", "");
                                $("#tabItems").attr("value", "");
                            },
                            btn: [
                                '提交',
                                '关闭'
                            ],
                            yes: function (index, layero) {
                                //  var jsonStr="{"id":102,"tabCarNum":"浙CEJ688","tabSafePerson":"彭成帮","tabYxState":"超级帅气","tabCarState":"客车","tabChannel":"平阳永顺","tabInsuranceCompanyName":"龙港太保","tabCdPerson":"吴玉修","tabWhPerson":"李学聪","tabAgentName":"杨思伟杨宗波","tabAmountSate":"已收","tabTeamOwnership":"杨思伟"}";
                                var channelName = $("#tabChannel1").val();
                                var tabAmountSate = $("#tabAmountSate1").val();
                                var nature = $(
                                    "#tabCarState1")
                                    .val();
                                //  var quality  = $("#qualitySelect").find("option:selected").text();
                                // var insurerId =$('#insuranceSelect option:selected') .val();
                                //var insurerId = $("#insuranceSelect").find("option:selected").text();
                                var agentId = $(
                                    "#tabAgentName1")
                                    .val();
                                var teamId = $(
                                    "#teamsSelect1")
                                    .val();
                                var whPersonSelect = $("#whPersonSelect").find("option:selected").text();
                                userInfo = JSON
                                    .parse(localStorage
                                        .getItem("userInfo"));
                                var tabSafePerson = $(
                                    "#sPerson")
                                    .val(); //客户
                                var yId = $(
                                    "#yId")
                                    .val(); //业务编码
                                var tabCarNum = $(
                                    "#tabCarNum1")
                                    .val(); //车牌
                                var tabYxState = $(
                                    "#tabYxState1")
                                    .val(); //险种
                                var tabStartDate = $(
                                    "#test91")
                                    .val(); //出单日期
                                var tabQdDate = $(
                                    "#test101")
                                    .val(); //生效时间结束
                                var tabEndDate = $(
                                    "#test111")
                                    .val(); //失效时间结束
                                var payState = $(
                                    "#payState")
                                    .val(); //付款方式
                                var tabAmountSate1 = $(
                                    "#tabAmountSate1")
                                    .val(); //收款状态
                                var tabMessage1 = $(
                                    "#tabMessage1")
                                    .val(); //备注
                                var jfys = $(
                                    "#jfys")
                                    .val(); //
                                var tab_ygzhjq_amount1 = $(
                                    "#tab_ygzhjq_amount1")
                                    .val(); //
                                var tab_ygzhsy_amount1 = $(
                                    "#tab_ygzhsy_amount1")
                                    .val(); //
                                var tab_jbfjql1 = $(
                                    "#tab_jbfjql1")
                                    .val(); //
                                var tabJbfsyl1 = $(
                                    "#tabJbfsyl1")
                                    .val(); //
                                var tab_zbf_j1 = $(
                                    "#tab_zbf_j1")
                                    .val(); //
                                var tabCustomerMobile1 = $(
                                    "#tabCustomerMobile1")
                                    .val(); //
                                var writePerson1 = $(
                                    "#writePerson1")
                                    .val(); //
                                var qitayongjin1 = $(
                                    "#qitayongjin1")
                                    .val(); //
                                var shishou1 = $(
                                    "#shishou1")
                                    .val(); //
                                var syx = $(
                                    "#syx")
                                    .val(); //
                                var jqx = $(
                                    "#jqx")
                                    .val(); //

                                var ccs = $(
                                    "#ccs")
                                    .val(); //
                                var xj = $(
                                    "#xj")
                                    .val();
                                var gsName = $(
                                    "#gsName")
                                    .val(); //
                                var allAmount1 = $(
                                    "#allAmount1")
                                    .val(); //

                                var tabBusinessNature = $("#tabBusinessNature1").val();
                                var tabIsRenewal = $("#tabIsRenewal1").val();
                                var tab_jqfyl = $("#tab_jqfyl").val();
                                var tab_syfyl = $("#tab_syfyl").val();
                                var tab_jqjbf = $("#tab_jqjbf").val();
                                var tab_syjbf = $("#tab_syjbf").val();
                                var tab_jqxfy = $("#tab_jqxfy").val();
                                var tab_syxfy = $("#tab_syxfy").val();
                                var tabIllustrate = $("#tabIllustrate").val();
                                var tabReserve = $("#tabReserve").val();
                                var tabItems = $("#tabItems").val();

                                var jsonStr = "{";

                                if (yId !== "") {
                                    jsonStr = jsonStr + "\"id\":" + yId;
                                }
                                if (tabBusinessNature !== "") {
                                    jsonStr = jsonStr + ",\"tabBusinessNature\":" + tabBusinessNature;
                                }
                                if (tabIsRenewal !== "") {
                                    jsonStr = jsonStr + ",\"tabIsRenewal\":" + tabIsRenewal;
                                }
                                if (tab_jqfyl !== "") {
                                    jsonStr = jsonStr + ",\"tabJqfyl\":" + tab_jqfyl;
                                }
                                if (tab_syfyl !== "") {
                                    jsonStr = jsonStr + ",\"tabSyfyl\":" + tab_syfyl;
                                }
                                if (tab_jqjbf !== "") {
                                    jsonStr = jsonStr + ",\"tabJqjbf\":" + tab_jqjbf;
                                }
                                if (tab_syjbf !== "") {
                                    jsonStr = jsonStr + ",\"tabSyjbf\":" + tab_syjbf;
                                }
                                if (tab_jqxfy !== "") {
                                    jsonStr = jsonStr + ",\"tabJqxfy\":" + tab_jqxfy;
                                }
                                if (tab_syxfy !== "") {
                                    jsonStr = jsonStr + ",\"tabSyxfy\":" + tab_syxfy;
                                }
                                if (tabIllustrate !== "") {
                                    jsonStr = jsonStr + ",\"tabIllustrate\":" + tabIllustrate;
                                }
                                if (tabReserve !== "") {
                                    jsonStr = jsonStr + ",\"tabReserve\":" + tabReserve;
                                }
                                if (tabItems !== "") {
                                    jsonStr = jsonStr + ",\"tabItems\":" + tabItems;
                                }
                                if (tabCarNum !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabCarNum\":" +
                                        tabCarNum;
                                }
                                if (payState !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabAgentPay\":" +
                                        payState;
                                }
                                if (tabAmountSate1 !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabAmountSate\":" +
                                        tabAmountSate1;
                                }
                                if (tabMessage1 !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabMessage\":" +
                                        tabMessage1;
                                }
                                if (jfys !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabJfysAmount\":" +
                                        jfys;
                                }
                                if (tab_ygzhjq_amount1 !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabYgzhjqAmount\":" +
                                        tab_ygzhjq_amount1;
                                }
                                if (tab_ygzhsy_amount1 !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabYgzhsyAmount\":" +
                                        tab_ygzhsy_amount1;
                                }
                                if (tab_jbfjql1 !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabJbfjql\":" +
                                        tab_jbfjql1;
                                }
                                if (tabJbfsyl1 !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabJbfsyl\":" +
                                        tabJbfsyl1;
                                }
                                if (tab_zbf_j1 !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabZbfJ\":" +
                                        tab_zbf_j1;
                                }
                                if (tabCustomerMobile1 !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabCustomerMobile\":" +
                                        tabCustomerMobile1;
                                }
                                if (writePerson1 !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabCdPerson\":" +
                                        writePerson1;
                                }
                                if (qitayongjin1 !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabCommissionOther\":" +
                                        qitayongjin1;
                                }
                                if (shishou1 !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabRealAmount\":" +
                                        shishou1;
                                }
                                if (syx !== "") {
                                    jsonStr = jsonStr + ",\"tabCommercialInsurance\":" + syx;
                                }
                                if (jqx !== "") {
                                    jsonStr = jsonStr + ",\"tabCompulsoryInsurance\":" + jqx;
                                }
                                if (ccs !== "") {
                                    jsonStr = jsonStr + ",\"tabTax\":" + ccs;
                                }
                                if (xj !== "") {
                                    jsonStr = jsonStr + ",\"tabCommissionAmount\":" + xj;
                                }
                                if (gsName !== "") {
                                    jsonStr = jsonStr + ",\"tabInsuranceCompanyName\":" + gsName;
                                }
                                if (allAmount1 !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabAllAmount\":" +
                                        allAmount1;
                                    jsonStr = jsonStr +
                                        ",\"tabSubtotal\":" +
                                        allAmount1;
                                }

                                if (tabYxState !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabYxState\":" +
                                        tabYxState;
                                }
                                if (nature !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabCarState\":" +
                                        nature;
                                }
                                if (channelName !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabChannel\":" +
                                        channelName;
                                }
                                if (agentId !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabAgentName\":" +
                                        agentId;
                                }

                                if (tabStartDate !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabStartDate\":\"" +
                                        tabStartDate +
                                        " \"";
                                }
                                if (tabQdDate !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabQdDate\":\"" +
                                        tabQdDate +
                                        " \"";
                                }
                                if (tabEndDate !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabEndDate\":\"" +
                                        tabEndDate +
                                        " \"";
                                }

                                if (tabSafePerson !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabSafePerson\":" +
                                        tabSafePerson;
                                }
                                if (teamId !== "") {
                                    jsonStr = jsonStr +
                                        ",\"tabTeamOwnership\":" +
                                        teamId;
                                }
                                /* if(insurerId!=""){
                                 jsonStr=jsonStr+",\"tabInsuranceCompanyName\":"+insurerId;
                                } */
                                if (whPersonSelect !== "") {
                                    jsonStr = jsonStr + ",\"tabWhPerson\":" + whPersonSelect;
                                }
                                if (jsonStr !== "{") {

                                    jsonStr = jsonStr +
                                        "}";
                                } else {
                                    jsonStr = null;
                                }

                                $.ajax({
                                    url: '/yxbx/uploadSoi',
                                    type: 'POST',
                                    data: {
                                        'soiId': checkitems[0].id,
                                        'userId': userInfo.userId,
                                        'updateParams': jsonStr
                                    },
                                    success: function (res) {
                                        var data = eval('(' + res + ')');
                                        console.log(data);
                                        if (data.msg === '权限不足') {
                                            alert('您的权限为' + userInfo.user_type + ',您只能增加比它大的用户权限');
                                        } else if (data.code === 0) {
                                            //这里以搜索为例
                                            location.reload();
                                            layer.closeAll();
                                            alert("修改成功");
                                            tableIns.reload({
                                                page: {
                                                    curr: 1 //重新从第 1 页开始
                                                }
                                            });
                                        } else {
                                            alert(data.msg);
                                        }
                                    },
                                    error: function (res) {
                                        alert("请求失败！");
                                        console.log(res);
                                    }
                                });
                                console.log('提交');
                            },

                            content: $('#prompt')
                            /*
                                 +'<div class="layui-upload">'+
                                 '<button type="button" class="layui-btn" id="testUp">附件上传</button>'+
                                 '<blockquote id="demo12" class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;width: 88%">'+
                                 '<div id="layer-photos-demo" class="layer-photos-demo">'+
                                 ' <div class="layui-upload-list uploader-list" style="overflow: auto;" id="demo2">'+

                                 '</div>'+

                                ' </div>+'+
                                '</blockquote>'+
                                 '</div>'	 */
                            ,

                            skin: 'layui-layer-rim',
                            area: [
                                '100%',
                                '98%'
                            ],
                            shadeClose: true, //开启遮罩关闭
                            resize: false
                        });
                    }
                );
            } else {
                alert("请勿同时编辑多条数据！");
            }
        }

        //监听工具条
        table
            .on(
                'tool(test1)',
                function (obj) { //注：tool是工具条事件名，test是table原始容器的属性 lay-filter="对应的值"
                    var data = obj.data; //获得当前行数据
                    var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
                    var tr = obj.tr; //获得当前行 tr 的DOM对象

                    // console.log(tr);

                    if (layEvent === 'detail') { //查看
                        //do somehing
                    } else if (layEvent === 'del') { //删除
                        layer
                            .confirm(
                                '是否删除这行数据？',
                                function (index) {
                                    /*   obj.del(); //删除对应行（tr）的DOM结构，并更新缓存
                                      layer.close(index); */
                                    //向服务端发送删除指令
                                    userInfo = JSON
                                        .parse(localStorage
                                            .getItem("userInfo"));
                                    $
                                        .ajax({
                                            url: '/yxbx/deleteInsuranceToUser',
                                            type: 'POST',
                                            data: {
                                                'fiId': data.id,
                                                'userId': userInfo.userId
                                            },
                                            success: function (
                                                res) {
                                                var data = eval('(' +
                                                    res +
                                                    ')');
                                                console
                                                    .log(data);
                                                if (data.msg === '权限不足') {
                                                    alert('您的权限为' +
                                                        userInfo.user_type +
                                                        ',您只能增加比它大的用户权限');

                                                } else if (data.code === 0) {
                                                    alert(data.msg);
                                                    //这里以搜索为例
                                                    tableIns
                                                        .reload({
                                                            /*    where: { //设定异步数据接口的额外参数，任意设
                                                                     aaaaaa: 'xxx'
                                                                     ,bbb: 'yyy'
                                                                      //…
                                                               }, */
                                                            page: {
                                                                curr: 1
                                                                //重新从第 1 页开始
                                                            }
                                                        });

                                                    layer
                                                        .close(layer.index);
                                                } else {
                                                    alert(data.msg);

                                                }
                                            },
                                            error: function (
                                                res) {
                                                alert("请求失败！");
                                                console
                                                    .log(res);
                                            }
                                        });

                                    // obj.del(); //删除对应行（tr）的DOM结构，并更新缓存
                                    /*  layer.close(index); */
                                    //向服务端发送删除指令
                                });
                    } else if (layEvent === 'edit') { //编辑

                        $.ajax({
                            url: '/yxbx/queryFile',
                            type: 'POST',
                            data: {
                                'trueSId': data.id,
                                'userId': userInfo.userId
                            },
                            success: function (res) {
                                var data = eval('(' +
                                    res + ')');
                                console.log(data);
                                if (data.msg === '权限不足') {
                                    alert('您的权限为' + userInfo.user_type + ',您只能增加比它大的用户权限');
                                } else if (data.code === 0) {
                                    var FileList = data.data;
                                    for (var i = 0; i < FileList.length; i++) {

                                        var imgUrl = fileBaseAdress + FileList[i].tabFileAddress;

                                        $('#demo2').append('<div id="" class="file-iteme">' + '<div class="handle" >' +
                                            FileList[i].tabFileAddress + '</div>' +
                                            '<img class="demo34" onclick="openImg(this)" style="width: 100px;height: 100px;"  src=' +
                                            imgUrl + '>' + '<div class="info">' + '点击头部删除' + '</div>' + '</div>');

                                        /*   if(i==0&&pt==null){
                                            $(document).ready(function(){
                                              //jquery方式
                                             //调用示例
                                            pt=  layer.photos({
                                               photos: '#layer-photos-demo'
                                               ,anim:-1//0-6的选择，指定弹出图片动画类型，默认随机（请注意，3.0之前的版本用shift参数）
                                              });
                                            });
                                           }  */

                                    }

                                    //	layer.close(layer.index);
                                } else {
                                    alert(data.msg);

                                }
                            },
                            error: function (res) {
                                alert("请求失败！");
                                console.log(res);
                            }
                        });

                        $("#hidden_trainSchemeId").attr(
                            "value", data.id);

                        $("#pistId").attr("value", data.id);
                        $("#tabBusinessID1").attr("value", data.tabBusinessID);
                        $("#tabCarNum1").attr("value", data.tabCarNum);
                        $("#tabAgentName1").attr("value", data.tabAgentName);
                        $("#tabCustomerMobile1").attr("value", data.tabCustomerMobile);
                        $("#sPerson").attr("value", data.tabSafePerson);
                        $("#tabCarState1").attr("value", data.tabCarState);
                        //  $("#tabCustomerMobile1").attr("value",data.tabCustomerMobile);

                        $("#test91").attr("value", data.tabStartDate);
                        $("#test101").attr("value", data.tabQdDate);
                        $("#test111").attr("value",
                            data.tabEndDate);
                        $("#teamsSelect1").attr("value",
                            data.tabTeamOwnership);
                        $("#tabChannel1").attr("value",
                            data.tabChannel);
                        $("#tabYxState1").attr("value",
                            data.tabYxState);
                        //  $("#hdzzl").attr("value",data.tabChannel);
                        $("#payState").attr("value",
                            data.tabCardState);
                        $("#tabAmountSate1").attr("value",
                            data.tabAmountSate);
                        $("#tabMessage1").html(data.tabMessage);
                        $("#jfys").attr("value",
                            data.tabJfysAmount);
                        $("#tab_ygzhjq_amount1").attr("value",
                            data.tabYgzhjqAmount);
                        $("#tab_ygzhsy_amount1").attr("value",
                            data.tabYgzhsyAmount);
                        $("#tab_jbfjql1").attr("value",
                            data.tabJbfjql);
                        $("#tabJbfsyl1").attr("value",
                            data.tabJbfsyl);
                        $("#tab_zbf_j1").attr("value",
                            data.tabZbfJ);
                        $("#writePerson1").attr("value",
                            data.tabCdPerson);
                        $("#qitayongjin1").attr("value",
                            data.tabCommissionOther);
                        $("#shishou1").attr("value",
                            data.tabRealAmount);
                        $("#syx").attr("value",
                            data.tabCommercialInsurance);

                        $("#jqx").attr("value", data.tabCompulsoryInsurance);
                        $("#ccs").attr("value", data.tabTax);
                        /*  $("#ifxbSelect").attr("value",data.tab_tax); */
                        /*  $("#ifxbSelect").attr("value",data.tabTax); */
                        $("#xj").attr("value", data.tabCommissionAmount);
                        $("#gsName").attr("value", data.tabInsuranceCompanyName);
                        $("#allAmount1").attr("value", data.tabAllAmount);

                        $("#tabBusinessNature1").attr("value", data.tabBusinessNature);
                        $("#tabIsRenewal1").attr("value", data.tabIsRenewal);
                        $("#tab_jqfyl").attr("value", data.tabJqfyl);
                        $("#tab_syfyl").attr("value", data.tabSyfyl);
                        $("#tab_jqjbf").attr("value", data.tabJqjbf);
                        $("#tab_syjbf").attr("value", data.tabSyjbf);
                        $("#tab_jqxfy").attr("value", data.tabJqxfy);
                        $("#tab_syxfy").attr("value", data.tabSyxfy);
                        $("#tabIllustrate").attr("value", data.tabIllustrate);
                        $("#tabReserve").attr("value", data.tabReserve);
                        $("#tabItems").attr("value", data.tabItems);

                        //上传

                        //弹出层
                        layui
                            .use(
                                'layer',
                                function () {
                                    var $ = layui.jquery,
                                        layer = layui.layer;

                                    layer
                                        .open({
                                            type: 1,
                                            id: data.id,
                                            title: [
                                                '编辑',
                                                'font-size:18px;'
                                            ],
                                            end: function () {
                                                $("#prompt").hide();
                                                $('.demo34').parent().remove();
                                                $('.info').parent().remove();

                                                $("#hidden_trainSchemeId").attr("value", "");
                                                $("#pistId").attr("value", "");
                                                $("#tabBusinessID1").attr("value", "");
                                                $("#tabCarNum1").attr("value", "");
                                                $("#tabAgentName1").attr("value", "");
                                                $("#tabCustomerMobile1").attr("value", "");
                                                $("#sPerson").attr("value", "");
                                                $("#tabCarState1").attr("value", "");
                                                //  $("#tabCustomerMobile1").attr("value", "");
                                                $("#test91").attr("value", "");
                                                $("#test101").attr("value", "");
                                                $("#test111").attr("value", "");
                                                $("#teamsSelect1").attr("value", "");
                                                $("#tabChannel1").attr("value", "");
                                                $("#tabYxState1").attr("value", "");
                                                //  $("#hdzzl").attr("value", "");
                                                $("#payState").attr("value", "");
                                                $("#tabAmountSate1").attr("value", "");
                                                $("#tabMessage1").html("");
                                                $("#jfys").attr("value", "");
                                                $("#tab_ygzhjq_amount1").attr("value", "");
                                                $("#tab_ygzhsy_amount1").attr("value", "");
                                                $("#tab_jbfjql1").attr("value", "");
                                                $("#tabJbfsyl1").attr("value", "");
                                                $("#tab_zbf_j1").attr("value", "");
                                                $("#writePerson1").attr("value", "");
                                                $("#qitayongjin1").attr("value", "");
                                                $("#shishou1").attr("value", "");
                                                $("#syx").attr("value", "");
                                                $("#jqx").attr("value", "");
                                                $("#ccs").attr("value", "");
                                                /*  $("#ifxbSelect").attr("value", ""); */
                                                /*  $("#ifxbSelect").attr("value", ""); */
                                                $("#xj").attr("value", "");
                                                $("#gsName").attr("value", "");
                                                $("#allAmount1").attr("value", "");

                                                $("#tabBusinessNature1").attr("value", "");
                                                $("#tabIsRenewal1").attr("value", "");
                                                $("#tab_jqfyl").attr("value", "");
                                                $("#tab_syfyl").attr("value", "");
                                                $("#tab_jqjbf").attr("value", "");
                                                $("#tab_syjbf").attr("value", "");
                                                $("#tab_jqxfy").attr("value", "");
                                                $("#tab_syxfy").attr("value", "");
                                                $("#tabIllustrate").attr("value", "");
                                                $("#tabReserve").attr("value", "");
                                                $("#tabItems").attr("value", "");

                                            },
                                            btn: [
                                                '提交',
                                                '关闭'
                                            ],
                                            yes: function (
                                                index,
                                                layero) {

                                                //  var jsonStr="{"id":102,"tabCarNum":"浙CEJ688","tabSafePerson":"彭成帮","tabYxState":"超级帅气","tabCarState":"客车","tabChannel":"平阳永顺","tabInsuranceCompanyName":"龙港太保","tabCdPerson":"吴玉修","tabWhPerson":"李学聪","tabAgentName":"杨思伟杨宗波","tabAmountSate":"已收","tabTeamOwnership":"杨思伟"}";
                                                var channelName = $("#tabChannel1").val();
                                                var tabAmountSate = $("#tabAmountSate1").val();
                                                var nature = $(
                                                    "#tabCarState1")
                                                    .val();
                                                //  var quality  = $("#qualitySelect").find("option:selected").text();
                                                // var insurerId =$('#insuranceSelect option:selected') .val();
                                                //var insurerId = $("#insuranceSelect").find("option:selected").text();
                                                var agentId = $(
                                                    "#tabAgentName1")
                                                    .val();
                                                var teamId = $(
                                                    "#teamsSelect1")
                                                    .val();
                                                var whPersonSelect = $("#whPersonSelect").find("option:selected").text();
                                                userInfo = JSON
                                                    .parse(localStorage
                                                        .getItem("userInfo"));
                                                var tabSafePerson = $(
                                                    "#sPerson")
                                                    .val(); //客户
                                                var yId = $(
                                                    "#yId")
                                                    .val(); //业务编码
                                                var tabCarNum = $(
                                                    "#tabCarNum1")
                                                    .val(); //车牌
                                                var tabYxState = $(
                                                    "#tabYxState1")
                                                    .val(); //险种
                                                var tabStartDate = $(
                                                    "#test91")
                                                    .val(); //出单日期
                                                var tabQdDate = $(
                                                    "#test101")
                                                    .val(); //生效时间结束
                                                var tabEndDate = $(
                                                    "#test111")
                                                    .val(); //失效时间结束
                                                var payState = $(
                                                    "#payState")
                                                    .val(); //付款方式
                                                var tabAmountSate1 = $(
                                                    "#tabAmountSate1")
                                                    .val(); //收款状态
                                                var tabMessage1 = $(
                                                    "#tabMessage1")
                                                    .val(); //备注
                                                var jfys = $(
                                                    "#jfys")
                                                    .val(); //
                                                var tab_ygzhjq_amount1 = $(
                                                    "#tab_ygzhjq_amount1")
                                                    .val(); //
                                                var tab_ygzhsy_amount1 = $(
                                                    "#tab_ygzhsy_amount1")
                                                    .val(); //
                                                var tab_jbfjql1 = $(
                                                    "#tab_jbfjql1")
                                                    .val(); //
                                                var tabJbfsyl1 = $(
                                                    "#tabJbfsyl1")
                                                    .val(); //
                                                var tab_zbf_j1 = $(
                                                    "#tab_zbf_j1")
                                                    .val(); //
                                                var tabCustomerMobile1 = $(
                                                    "#tabCustomerMobile1")
                                                    .val(); //
                                                var writePerson1 = $(
                                                    "#writePerson1")
                                                    .val(); //
                                                var qitayongjin1 = $(
                                                    "#qitayongjin1")
                                                    .val(); //
                                                var shishou1 = $(
                                                    "#shishou1")
                                                    .val(); //
                                                var syx = $(
                                                    "#syx")
                                                    .val(); //
                                                var jqx = $(
                                                    "#jqx")
                                                    .val(); //

                                                var ccs = $(
                                                    "#ccs")
                                                    .val(); //
                                                var xj = $(
                                                    "#xj")
                                                    .val();
                                                var gsName = $(
                                                    "#gsName")
                                                    .val(); //
                                                var allAmount1 = $(
                                                    "#allAmount1")
                                                    .val(); //

                                                var tabBusinessNature = $("#tabBusinessNature1").val();
                                                var tabIsRenewal = $("#tabIsRenewal1").val();
                                                var tab_jqfyl = $("#tab_jqfyl").val();
                                                var tab_syfyl = $("#tab_syfyl").val();
                                                var tab_jqjbf = $("#tab_jqjbf").val();
                                                var tab_syjbf = $("#tab_syjbf").val();
                                                var tab_jqxfy = $("#tab_jqxfy").val();
                                                var tab_syxfy = $("#tab_syxfy").val();
                                                var tabIllustrate = $("#tabIllustrate").val();
                                                var tabReserve = $("#tabReserve").val();
                                                var tabItems = $("#tabItems").val();

                                                var jsonStr = "{";

                                                if (yId !== "") {
                                                    jsonStr = jsonStr + "\"id\":" + yId;
                                                }
                                                if (tabBusinessNature !== "") {
                                                    jsonStr = jsonStr + ",\"tabBusinessNature\":" + tabBusinessNature;
                                                }
                                                if (tabIsRenewal !== "") {
                                                    jsonStr = jsonStr + ",\"tabIsRenewal\":" + tabIsRenewal;
                                                }
                                                if (tab_jqfyl !== "") {
                                                    jsonStr = jsonStr + ",\"tabJqfyl\":" + tab_jqfyl;
                                                }
                                                if (tab_syfyl !== "") {
                                                    jsonStr = jsonStr + ",\"tabSyfyl\":" + tab_syfyl;
                                                }
                                                if (tab_jqjbf !== "") {
                                                    jsonStr = jsonStr + ",\"tabJqjbf\":" + tab_jqjbf;
                                                }
                                                if (tab_syjbf !== "") {
                                                    jsonStr = jsonStr + ",\"tabSyjbf\":" + tab_syjbf;
                                                }
                                                if (tab_jqxfy !== "") {
                                                    jsonStr = jsonStr + ",\"tabJqxfy\":" + tab_jqxfy;
                                                }
                                                if (tab_syxfy !== "") {
                                                    jsonStr = jsonStr + ",\"tabSyxfy\":" + tab_syxfy;
                                                }
                                                if (tabIllustrate !== "") {
                                                    jsonStr = jsonStr + ",\"tabIllustrate\":" + tabIllustrate;
                                                }
                                                if (tabReserve !== "") {
                                                    jsonStr = jsonStr + ",\"tabReserve\":" + tabReserve;
                                                }
                                                if (tabItems !== "") {
                                                    jsonStr = jsonStr + ",\"tabItems\":" + tabItems;
                                                }

                                                if (tabCarNum !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabCarNum\":" +
                                                        tabCarNum;
                                                }
                                                if (payState !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabAgentPay\":" +
                                                        payState;
                                                }
                                                if (tabAmountSate1 !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabAmountSate\":" +
                                                        tabAmountSate1;
                                                }
                                                if (tabMessage1 !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabMessage\":" +
                                                        tabMessage1;
                                                }
                                                if (jfys !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabJfysAmount\":" +
                                                        jfys;
                                                }
                                                if (tab_ygzhjq_amount1 !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabYgzhjqAmount\":" +
                                                        tab_ygzhjq_amount1;
                                                }
                                                if (tab_ygzhsy_amount1 !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabYgzhsyAmount\":" +
                                                        tab_ygzhsy_amount1;
                                                }
                                                if (tab_jbfjql1 !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabJbfjql\":" +
                                                        tab_jbfjql1;
                                                }
                                                if (tabJbfsyl1 !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabJbfsyl\":" +
                                                        tabJbfsyl1;
                                                }
                                                if (tab_zbf_j1 !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabZbfJ\":" +
                                                        tab_zbf_j1;
                                                }
                                                if (tabCustomerMobile1 !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabCustomerMobile\":" +
                                                        tabCustomerMobile1;
                                                }
                                                if (writePerson1 !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabCdPerson\":" +
                                                        writePerson1;
                                                }
                                                if (qitayongjin1 !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabCommissionOther\":" +
                                                        qitayongjin1;
                                                }
                                                if (shishou1 !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabRealAmount\":" +
                                                        shishou1;
                                                }
                                                if (syx !== "") {
                                                    jsonStr = jsonStr + ",\"tabCommercialInsurance\":" + syx;
                                                }
                                                if (jqx !== "") {
                                                    jsonStr = jsonStr + ",\"tabCompulsoryInsurance\":" + jqx;
                                                }
                                                if (ccs !== "") {
                                                    jsonStr = jsonStr + ",\"tabTax\":" + ccs;
                                                }
                                                if (xj !== "") {
                                                    jsonStr = jsonStr + ",\"tabCommissionAmount\":" + xj;
                                                }
                                                if (gsName !== "") {
                                                    jsonStr = jsonStr + ",\"tabInsuranceCompanyName\":" + gsName;
                                                }
                                                if (allAmount1 !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabAllAmount\":" +
                                                        allAmount1;
                                                    jsonStr = jsonStr +
                                                        ",\"tabSubtotal\":" +
                                                        allAmount1;
                                                }

                                                if (tabYxState !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabYxState\":" +
                                                        tabYxState;
                                                }
                                                if (nature !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabCarState\":" +
                                                        nature;
                                                }
                                                if (channelName !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabChannel\":" +
                                                        channelName;
                                                }
                                                if (agentId !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabAgentName\":" +
                                                        agentId;
                                                }

                                                if (tabStartDate !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabStartDate\":\"" +
                                                        tabStartDate +
                                                        " \"";
                                                }
                                                if (tabQdDate !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabQdDate\":\"" +
                                                        tabQdDate +
                                                        " \"";
                                                }
                                                if (tabEndDate !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabEndDate\":\"" +
                                                        tabEndDate +
                                                        " \"";
                                                }

                                                if (tabSafePerson !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabSafePerson\":" +
                                                        tabSafePerson;
                                                }
                                                if (teamId !== "") {
                                                    jsonStr = jsonStr +
                                                        ",\"tabTeamOwnership\":" +
                                                        teamId;
                                                }
                                                /* if(insurerId!=""){
                                                 jsonStr=jsonStr+",\"tabInsuranceCompanyName\":"+insurerId;
                                                } */
                                                if (whPersonSelect !== "") {
                                                    jsonStr = jsonStr + ",\"tabWhPerson\":" + whPersonSelect;
                                                }
                                                if (jsonStr !== "{") {

                                                    jsonStr = jsonStr +
                                                        "}";
                                                } else {
                                                    jsonStr = null;
                                                }

                                                $.ajax({
                                                    url: '/yxbx/uploadSoi',
                                                    type: 'POST',
                                                    data: {
                                                        'soiId': data.id,
                                                        'userId': userInfo.userId,
                                                        'updateParams': jsonStr
                                                    },
                                                    success: function (
                                                        res) {
                                                        var data = eval('(' +
                                                            res +
                                                            ')');
                                                        console
                                                            .log(data);
                                                        if (data.msg === '权限不足') {
                                                            alert('您的权限为' +
                                                                userInfo.user_type +
                                                                ',您只能增加比它大的用户权限');

                                                        } else if (data.code === 0) {
                                                            //这里以搜索为例
                                                            location
                                                                .reload();

                                                            layer
                                                                .closeAll();
                                                            alert("修改成功");

                                                            //	layer.close(layer.index);
                                                        } else {
                                                            alert(data.msg);

                                                        }
                                                    },
                                                    error: function (
                                                        res) {
                                                        alert("请求失败！");
                                                        console
                                                            .log(res);
                                                    }
                                                });
                                                console
                                                    .log('提交');
                                            },

                                            content: $('#prompt')
                                            /*
                                                 +'<div class="layui-upload">'+
                                                 '<button type="button" class="layui-btn" id="testUp">附件上传</button>'+
                                                 '<blockquote id="demo12" class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;width: 88%">'+
                                                 '<div id="layer-photos-demo" class="layer-photos-demo">'+
                                                 ' <div class="layui-upload-list uploader-list" style="overflow: auto;" id="demo2">'+

                                                 '</div>'+

                                                ' </div>+'+
                                                '</blockquote>'+
                                                 '</div>'	 */
                                            ,

                                            skin: 'layui-layer-rim',
                                            area: [
                                                '100%',
                                                '98%'
                                            ],
                                            shadeClose: true, //开启遮罩关闭
                                            resize: false
                                        });
                                });

                    }
                });
        $(document).on("mouseenter mouseleave", ".file-iteme",
            function (event) {
                if (event.type === "mouseenter") {
                    //鼠标悬浮
                    $(this).children(".info").fadeIn("fast");
                    $(this).children(".handle").fadeIn("fast");

                } else if (event.type === "mouseleave") {
                    //鼠标离开
                    $(this).children(".info").hide();
                    $(this).children(".handle").hide();
                }
            });
        // 删除图片
        // 删除图片
        $(document).on(
            "click",
            ".file-iteme .handle",
            function (event) {

                var s = $(this);

                console.log(s.html());

                layer.confirm('您确定要删除该图片吗?', {
                    btn: ['确定', '取消'],
                    title: "提示"
                }, function () {
                    layer.close(layer.index);
                    $.ajax({
                        url: '/yxbx/deletefile',
                        type: 'POST',
                        data: {
                            'trueSId': $("#pistId").val(),
                            'userId': userInfo.userId,
                            'imgUrl': s.html()
                        },
                        success: function (res) {
                            var data = eval('(' + res + ')');
                            console.log(data);
                            if (data.msg === '权限不足') {
                                alert('您的权限为' + userInfo.user_type +
                                    ',您只能增加比它大的用户权限');

                            } else if (data.code === 0) {
                                alert("删除成功");
                                s.parent().remove();
                                //	layer.close(layer.index);
                            } else if (data.code === 1) {
                                alert("删除成功");
                                for (var j = 0; j < fileArr.length; j++) {
                                    if (fileArr[j] === s.html()) {
                                        fileArr.splice(j, 1);
                                    }
                                }
                                s.parent().remove();
                                //	layer.close(layer.index);
                            } else {
                                alert(data.msg);
                            }
                        },
                        error: function (res) {
                            alert("请求失败！")
                            console.log(res);
                        }
                    });
                    // s.parent().remove();
                });
            });

        //jquery方式
        //调用示例
        var pt = layer.photos({
            photos: '#layer-photos-demo',
            anim: -1
            //0-6的选择，指定弹出图片动画类型，默认随机（请注意，3.0之前的版本用shift参数）
        });
        ss = 0;

        function openImg(img) {

            layer.open({
                type: 1,
                title: false,
                skin: 'layui-layer-demo', //样式类名
                closeBtn: 0, //不显示关闭按钮
                anim: -1,
                shade: 0.6,
                maxmin: true,
                area: ['auto', '100%'],
                shadeClose: true, //开启遮罩关闭
                content: '<img style="height:100%;"   ' +
                    'onmousewheel="return bigimg(this)" style="cursor:pointer"' +
                    ' src=' + img.src + '>'
            });
        }

        function bigimg(obj) {
            //alert(parseInt(obj.style.zoom,10));
            var zoom = parseInt(obj.style.zoom, 10) || 100;
            zoom += event.wheelDelta / 12;
            if (zoom > 0)
                obj.style.zoom = zoom + '%';
            return false;
        }

        function adOnclick(data) {

            $.ajax({
                url: '/yxbx/queryFile',
                type: 'POST',
                data: {
                    'trueSId': data.id,
                    'userId': userInfo.userId
                },
                success: function (res) {
                    var data = eval('(' + res + ')');
                    console.log(data);
                    if (data.msg === '权限不足') {
                        alert('您的权限为' + userInfo.user_type +
                            ',您只能增加比它大的用户权限');

                    } else if (data.code === 0) {
                        var FileList = data.data;
                        for (var i = 0; i < FileList.length; i++) {

                            var imgUrl = fileBaseAdress +
                                FileList[i].tabFileAddress;

                            $('#demo2')
                                .append(
                                    '<div id="" class="file-iteme">' +
                                    '<div class="handle"><span class="glyphicon glyphicon-trash"></span></div>' +
                                    '<img class="demo34" onclick="openImg(this)" style="width: 100px;height: 100px;"  src=' +
                                    imgUrl +
                                    '>' +
                                    '<div class="info">' +
                                    FileList[i].tabFileAddress +
                                    '</div>' +
                                    '</div>');

                            /*   if(i==0&&pt==null){
                                $(document).ready(function(){
                                  //jquery方式
                                 //调用示例
                                pt=  layer.photos({
                                   photos: '#layer-photos-demo'
                                   ,anim:-1//0-6的选择，指定弹出图片动画类型，默认随机（请注意，3.0之前的版本用shift参数）
                                  });
                                });
                               }  */

                        }

                        //	layer.close(layer.index);
                    } else {
                        alert(data.msg);

                    }
                },
                error: function (res) {
                    alert("请求失败！");
                    console.log(res);
                }
            });

            $("#hidden_trainSchemeId").attr("value", data.id);

            $("#pistId").attr("value", data.id);
            $("#tabBusinessID1").attr("value", data.tabBusinessID);
            $("#tabCarNum1").attr("value", data.tabCarNum);
            $("#tabAgentName1").attr("value", data.tabAgentName);
            $("#tabCustomerMobile1").attr("value",
                data.tabCustomerMobile);
            $("#sPerson").attr("value", data.tabSafePerson);
            $("#tabCarState1").attr("value", data.tabCarState);
            //  $("#tabCustomerMobile1").attr("value",data.tabCustomerMobile);

            $("#test91").attr("value", data.tabStartDate);
            $("#test101").attr("value", data.tabQdDate);
            $("#test111").attr("value", data.tabEndDate);
            $("#teamsSelect1").attr("value", data.tabTeamOwnership);
            $("#tabChannel1").attr("value", data.tabChannel);
            $("#tabYxState1").attr("value", data.tabYxState);
            //  $("#hdzzl").attr("value",data.tabChannel);
            $("#payState").attr("value", data.tabCardState);
            $("#tabAmountSate1").attr("value", data.tabAmountSate);
            $("#tabMessage1").html(data.tabMessage);
            $("#jfys").attr("value", data.tabJfysAmount);
            $("#tab_ygzhjq_amount1")
                .attr("value", data.tabYgzhjqAmount);
            $("#tab_ygzhsy_amount1")
                .attr("value", data.tabYgzhsyAmount);
            $("#tab_jbfjql1").attr("value", data.tabJbfjql);
            $("#tabJbfsyl1").attr("value", data.tabJbfsyl);
            $("#tab_zbf_j1").attr("value", data.tabZbfJ);
            $("#writePerson1").attr("value", data.tabCdPerson);
            $("#qitayongjin1").attr("value", data.tabCommissionOther);
            $("#shishou1").attr("value", data.tabRealAmount);
            $("#syx").attr("value", data.tabCommercialInsurance);

            $("#jqx").attr("value", data.tabCompulsoryInsurance);
            $("#ccs").attr("value", data.tabTax);
            /*  $("#ifxbSelect").attr("value",data.tab_tax); */
            /*  $("#ifxbSelect").attr("value",data.tabTax); */
            $("#xj").attr("value", data.tabCommissionAmount);
            $("#gsName").attr("value", data.tabInsuranceCompanyName);
            $("#allAmount1").attr("value", data.tabAllAmount);

            $("#tabBusinessNature1").attr("value", data.tabBusinessNature);
            $("#tabIsRenewal1").attr("value", data.tabIsRenewal);
            $("#tab_jqfyl").attr("value", data.tabJqfyl);
            $("#tab_syfyl").attr("value", data.tabSyfyl);
            $("#tab_jqjbf").attr("value", data.tabJqjbf);
            $("#tab_syjbf").attr("value", data.tabSyjbf);
            $("#tab_jqxfy").attr("value", data.tabJqxfy);
            $("#tab_syxfy").attr("value", data.tabSyxfy);
            $("#tabIllustrate").attr("value", data.tabIllustrate);
            $("#tabReserve").attr("value", data.tabReserve);
            $("#tabItems").attr("value", data.tabItems);

            //上传

            //弹出层
            layui
                .use(
                    'layer',
                    function () {
                        var $ = layui.jquery,
                            layer = layui.layer;

                        layer
                            .open({
                                type: 1,
                                id: data.id,
                                title: ['编辑',
                                    'font-size:18px;'
                                ],
                                end: function () {

                                    $("#prompt").hide();
                                    $('.demo34').parent().remove();
                                    $('.info').parent().remove();

                                    $("#hidden_trainSchemeId").attr("value", "");
                                    $("#pistId").attr("value", "");
                                    $("#tabBusinessID1").attr("value", "");
                                    $("#tabCarNum1").attr("value", "");
                                    $("#tabAgentName1").attr("value", "");
                                    $("#tabCustomerMobile1").attr("value", "");
                                    $("#sPerson").attr("value", "");
                                    $("#tabCarState1").attr("value", "");
                                    //  $("#tabCustomerMobile1").attr("value", "");
                                    $("#test91").attr("value", "");
                                    $("#test101").attr("value", "");
                                    $("#test111").attr("value", "");
                                    $("#teamsSelect1").attr("value", "");
                                    $("#tabChannel1").attr("value", "");
                                    $("#tabYxState1").attr("value", "");
                                    //  $("#hdzzl").attr("value", "");
                                    $("#payState").attr("value", "");
                                    $("#tabAmountSate1").attr("value", "");
                                    $("#tabMessage1").html("");
                                    $("#jfys").attr("value", "");
                                    $("#tab_ygzhjq_amount1").attr("value", "");
                                    $("#tab_ygzhsy_amount1").attr("value", "");
                                    $("#tab_jbfjql1").attr("value", "");
                                    $("#tabJbfsyl1").attr("value", "");
                                    $("#tab_zbf_j1").attr("value", "");
                                    $("#writePerson1").attr("value", "");
                                    $("#qitayongjin1").attr("value", "");
                                    $("#shishou1").attr("value", "");
                                    $("#syx").attr("value", "");
                                    $("#jqx").attr("value", "");
                                    $("#ccs").attr("value", "");
                                    /*  $("#ifxbSelect").attr("value", ""); */
                                    /*  $("#ifxbSelect").attr("value", ""); */
                                    $("#xj").attr("value", "");
                                    $("#gsName").attr("value", "");
                                    $("#allAmount1").attr("value", "");

                                    $("#tabBusinessNature1").attr("value", "");
                                    $("#tabIsRenewal1").attr("value", "");
                                    $("#tab_jqfyl").attr("value", "");
                                    $("#tab_syfyl").attr("value", "");
                                    $("#tab_jqjbf").attr("value", "");
                                    $("#tab_syjbf").attr("value", "");
                                    $("#tab_jqxfy").attr("value", "");
                                    $("#tab_syxfy").attr("value", "");
                                    $("#tabIllustrate").attr("value", "");
                                    $("#tabReserve").attr("value", "");
                                    $("#tabItems").attr("value", "");

                                },
                                btn: ['提交', '关闭'],
                                yes: function (index,
                                    layero) {

                                    //  var jsonStr="{"id":102,"tabCarNum":"浙CEJ688","tabSafePerson":"彭成帮","tabYxState":"超级帅气","tabCarState":"客车","tabChannel":"平阳永顺","tabInsuranceCompanyName":"龙港太保","tabCdPerson":"吴玉修","tabWhPerson":"李学聪","tabAgentName":"杨思伟杨宗波","tabAmountSate":"已收","tabTeamOwnership":"杨思伟"}";
                                    var channelName = $("#tabChannel1").val();
                                    var tabAmountSate = $("#tabAmountSate1").val();
                                    var nature = $("#tabCarState1").val();
                                    //  var quality  = $("#qualitySelect").find("option:selected").text();
                                    // var insurerId =$('#insuranceSelect option:selected') .val();
                                    //var insurerId = $("#insuranceSelect").find("option:selected").text();
                                    var agentId = $(
                                        "#tabAgentName1")
                                        .val();
                                    var teamId = $(
                                        "#teamsSelect1")
                                        .val();
                                    var whPersonSelect = $("#whPersonSelect").find("option:selected").text();
                                    userInfo = JSON
                                        .parse(localStorage
                                            .getItem("userInfo"));
                                    var tabSafePerson = $(
                                        "#sPerson")
                                        .val(); //客户
                                    var yId = $("#yId")
                                        .val(); //业务编码
                                    var tabCarNum = $(
                                        "#tabCarNum1")
                                        .val(); //车牌
                                    var tabYxState = $(
                                        "#tabYxState1")
                                        .val(); //险种
                                    var tabStartDate = $(
                                        "#test91")
                                        .val(); //出单日期
                                    var tabQdDate = $(
                                        "#test101")
                                        .val(); //生效时间结束
                                    var tabEndDate = $(
                                        "#test111")
                                        .val(); //失效时间结束
                                    var payState = $(
                                        "#payState")
                                        .val(); //付款方式
                                    var tabAmountSate1 = $(
                                        "#tabAmountSate1")
                                        .val(); //收款状态
                                    var tabMessage1 = $(
                                        "#tabMessage1")
                                        .val(); //备注
                                    var jfys = $("#jfys")
                                        .val(); //
                                    var tab_ygzhjq_amount1 = $(
                                        "#tab_ygzhjq_amount1")
                                        .val(); //
                                    var tab_ygzhsy_amount1 = $(
                                        "#tab_ygzhsy_amount1")
                                        .val(); //
                                    var tab_jbfjql1 = $(
                                        "#tab_jbfjql1")
                                        .val(); //
                                    var tabJbfsyl1 = $(
                                        "#tabJbfsyl1")
                                        .val(); //
                                    var tab_zbf_j1 = $(
                                        "#tab_zbf_j1")
                                        .val(); //
                                    var tabCustomerMobile1 = $(
                                        "#tabCustomerMobile1")
                                        .val(); //
                                    var writePerson1 = $(
                                        "#writePerson1")
                                        .val(); //
                                    var qitayongjin1 = $(
                                        "#qitayongjin1")
                                        .val(); //
                                    var shishou1 = $(
                                        "#shishou1")
                                        .val(); //
                                    var syx = $("#syx")
                                        .val(); //
                                    var jqx = $("#jqx")
                                        .val(); //

                                    var ccs = $("#ccs")
                                        .val(); //
                                    var xj = $("#xj").val();
                                    var gsName = $(
                                        "#gsName")
                                        .val(); //
                                    var allAmount1 = $(
                                        "#allAmount1")
                                        .val(); //

                                    var tabBusinessNature = $("#tabBusinessNature1").val();
                                    var tabIsRenewal = $("#tabIsRenewal1").val();
                                    var tab_jqfyl = $("#tab_jqfyl").val();
                                    var tab_syfyl = $("#tab_syfyl").val();
                                    var tab_jqjbf = $("#tab_jqjbf").val();
                                    var tab_syjbf = $("#tab_syjbf").val();
                                    var tab_jqxfy = $("#tab_jqxfy").val();
                                    var tab_syxfy = $("#tab_syxfy").val();
                                    var tabIllustrate = $("#tabIllustrate").val();
                                    var tabReserve = $("#tabReserve").val();
                                    var tabItems = $("#tabItems").val();

                                    var jsonStr = "{";

                                    if (yId !== "") {
                                        jsonStr = jsonStr + "\"id\":" + yId;
                                    }
                                    if (tabBusinessNature !== "") {
                                        jsonStr = jsonStr + ",\"tabBusinessNature\":" + tabBusinessNature;
                                    }
                                    if (tabIsRenewal !== "") {
                                        jsonStr = jsonStr + ",\"tabIsRenewal\":" + tabIsRenewal;
                                    }
                                    if (tab_jqfyl !== "") {
                                        jsonStr = jsonStr + ",\"tabJqfyl\":" + tab_jqfyl;
                                    }
                                    if (tab_syfyl !== "") {
                                        jsonStr = jsonStr + ",\"tabSyfyl\":" + tab_syfyl;
                                    }
                                    if (tab_jqjbf !== "") {
                                        jsonStr = jsonStr + ",\"tabJqjbf\":" + tab_jqjbf;
                                    }
                                    if (tab_syjbf !== "") {
                                        jsonStr = jsonStr + ",\"tabSyjbf\":" + tab_syjbf;
                                    }
                                    if (tab_jqxfy !== "") {
                                        jsonStr = jsonStr + ",\"tabJqxfy\":" + tab_jqxfy;
                                    }
                                    if (tab_syxfy !== "") {
                                        jsonStr = jsonStr + ",\"tabSyxfy\":" + tab_syxfy;
                                    }
                                    if (tabIllustrate !== "") {
                                        jsonStr = jsonStr + ",\"tabIllustrate\":" + tabIllustrate;
                                    }
                                    if (tabReserve !== "") {
                                        jsonStr = jsonStr + ",\"tabReserve\":" + tabReserve;
                                    }
                                    if (tabItems !== "") {
                                        jsonStr = jsonStr + ",\"tabItems\":" + tabItems;
                                    }

                                    if (tabCarNum !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabCarNum\":" +
                                            tabCarNum;
                                    }
                                    if (payState !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabAgentPay\":" +
                                            payState;
                                    }
                                    if (tabAmountSate1 !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabAmountSate\":" +
                                            tabAmountSate1;
                                    }
                                    if (tabMessage1 !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabMessage\":" +
                                            tabMessage1;
                                    }
                                    if (jfys !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabJfysAmount\":" +
                                            jfys;
                                    }
                                    if (tab_ygzhjq_amount1 !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabYgzhjqAmount\":" +
                                            tab_ygzhjq_amount1;
                                    }
                                    if (tab_ygzhsy_amount1 !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabYgzhsyAmount\":" +
                                            tab_ygzhsy_amount1;
                                    }
                                    if (tab_jbfjql1 !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabJbfjql\":" +
                                            tab_jbfjql1;
                                    }
                                    if (tabJbfsyl1 !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabJbfsyl\":" +
                                            tabJbfsyl1;
                                    }
                                    if (tab_zbf_j1 !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabZbfJ\":" +
                                            tab_zbf_j1;
                                    }
                                    if (tabCustomerMobile1 !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabCustomerMobile\":" +
                                            tabCustomerMobile1;
                                    }
                                    if (writePerson1 !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabCdPerson\":" +
                                            writePerson1;
                                    }
                                    if (qitayongjin1 !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabCommissionOther\":" +
                                            qitayongjin1;
                                    }
                                    if (shishou1 !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabRealAmount\":" +
                                            shishou1;
                                    }
                                    if (syx !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabCommercialInsurance\":" +
                                            syx;
                                    }
                                    if (jqx !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabCompulsoryInsurance\":" +
                                            jqx;
                                    }
                                    if (ccs !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabTax\":" +
                                            ccs;
                                    }
                                    if (xj !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabCommissionAmount\":" +
                                            xj;
                                    }
                                    if (gsName !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabInsuranceCompanyName\":" +
                                            gsName;
                                    }
                                    if (allAmount1 !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabAllAmount\":" +
                                            allAmount1;
                                        jsonStr = jsonStr +
                                            ",\"tabSubtotal\":" +
                                            allAmount1;
                                    }

                                    if (tabYxState !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabYxState\":" +
                                            tabYxState;
                                    }
                                    if (nature !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabCarState\":" +
                                            nature;
                                    }
                                    if (channelName !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabChannel\":" +
                                            channelName;
                                    }
                                    if (agentId !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabAgentName\":" +
                                            agentId;
                                    }

                                    if (tabStartDate !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabStartDate\":\"" +
                                            tabStartDate +
                                            " \"";
                                    }
                                    if (tabQdDate !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabQdDate\":\"" +
                                            tabQdDate +
                                            " \"";
                                    }
                                    if (tabEndDate !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabEndDate\":\"" +
                                            tabEndDate +
                                            " \"";
                                    }

                                    if (tabSafePerson !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabSafePerson\":" +
                                            tabSafePerson;
                                    }
                                    if (teamId !== "") {
                                        jsonStr = jsonStr +
                                            ",\"tabTeamOwnership\":" +
                                            teamId;
                                    }
                                    /* if(insurerId!=""){
                                     jsonStr=jsonStr+",\"tabInsuranceCompanyName\":"+insurerId;
                                    } */
                                    if (whPersonSelect !== "") {
                                        jsonStr = jsonStr + ",\"tabWhPerson\":" + whPersonSelect;
                                    }
                                    if (jsonStr !== "{") {

                                        jsonStr = jsonStr +
                                            "}";
                                    } else {
                                        jsonStr = null;
                                    }

                                    $.ajax({
                                        url: '/yxbx/uploadSoi',
                                        type: 'POST',
                                        data: {
                                            'soiId': data.id,
                                            'userId': userInfo.userId,
                                            'updateParams': jsonStr
                                        },
                                        success: function (
                                            res) {
                                            var data = eval('(' +
                                                res +
                                                ')');
                                            console
                                                .log(data);
                                            if (data.msg === '权限不足') {
                                                alert('您的权限为' +
                                                    userInfo.user_type +
                                                    ',您只能增加比它大的用户权限');

                                            } else if (data.code === 0) {
                                                //这里以搜索为例
                                                location
                                                    .reload();

                                                layer
                                                    .closeAll();
                                                alert("修改成功");

                                                //	layer.close(layer.index);
                                            } else {
                                                alert(data.msg);

                                            }
                                        },
                                        error: function (
                                            res) {
                                            alert("请求失败！");
                                            console
                                                .log(res);
                                        }
                                    });
                                    console.log('提交');
                                },

                                content: $('#prompt')
                                /*
                                     +'<div class="layui-upload">'+
                                     '<button type="button" class="layui-btn" id="testUp">附件上传</button>'+
                                     '<blockquote id="demo12" class="layui-elem-quote layui-quote-nm" style="margin-top: 10px;width: 88%">'+
                                     '<div id="layer-photos-demo" class="layer-photos-demo">'+
                                     ' <div class="layui-upload-list uploader-list" style="overflow: auto;" id="demo2">'+

                                     '</div>'+

                                    ' </div>+'+
                                    '</blockquote>'+
                                     '</div>'	 */
                                ,

                                skin: 'layui-layer-rim',
                                area: ['100%', '98%'],
                                shadeClose: true, //开启遮罩关闭
                                resize: false
                            });
                    });

        }
    </script>
</body>

</html>